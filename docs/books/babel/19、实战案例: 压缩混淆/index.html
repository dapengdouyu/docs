<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="Dapengçš„åšå®¢ Blog RSS Feed">
<script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?7dda2565ba246ecd62878c13153e2941",e.defer=!0;var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
<meta name="baidu-site-verification" content="IXU12YQUjF">
<link rel="preconnect" href="https://hmcdn.baidu.com">
<link rel="stylesheet" href="https://cansiny.oss-cn-shanghai.aliyuncs.com/assets/fonts.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><title data-react-helmet="true">19ã€å®æˆ˜æ¡ˆä¾‹: å‹ç¼©æ··æ·† - Dapengçš„åšå®¢</title><meta data-react-helmet="true" property="og:url" content="https://dapengdouyu.github.io/docs/books/babel/19ã€å®æˆ˜æ¡ˆä¾‹: å‹ç¼©æ··æ·†"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="19ã€å®æˆ˜æ¡ˆä¾‹: å‹ç¼©æ··æ·† - Dapengçš„åšå®¢"><meta data-react-helmet="true" name="description" content="å‹ç¼©æ··æ·†å·¥å…·æ˜¯å‰ç«¯å¿…ç”¨çš„å·¥å…·ä¹‹ä¸€ï¼Œä»£ç åœ¨ä¸Šçº¿ä¹‹é—´éœ€è¦ç»è¿‡å‹ç¼©æ¥å‡å°ä½“ç§¯ï¼Œå¹¶ä¸”ä¼šåšä¸€äº›ç®€å•çš„æ··æ·†æ¥é˜²æ­¢æºç ç›´æ¥æ³„æ¼ã€‚å‰ç«¯å·¥ç¨‹å¸ˆå¯èƒ½æ¯å¤©éƒ½åœ¨ç”¨è¿™ç§å·¥å…·ï¼Œå¯ä½ æœ‰æƒ³è¿‡å®ƒçš„å®ç°åŸç†ä¹ˆï¼Ÿ"><meta data-react-helmet="true" property="og:description" content="å‹ç¼©æ··æ·†å·¥å…·æ˜¯å‰ç«¯å¿…ç”¨çš„å·¥å…·ä¹‹ä¸€ï¼Œä»£ç åœ¨ä¸Šçº¿ä¹‹é—´éœ€è¦ç»è¿‡å‹ç¼©æ¥å‡å°ä½“ç§¯ï¼Œå¹¶ä¸”ä¼šåšä¸€äº›ç®€å•çš„æ··æ·†æ¥é˜²æ­¢æºç ç›´æ¥æ³„æ¼ã€‚å‰ç«¯å·¥ç¨‹å¸ˆå¯èƒ½æ¯å¤©éƒ½åœ¨ç”¨è¿™ç§å·¥å…·ï¼Œå¯ä½ æœ‰æƒ³è¿‡å®ƒçš„å®ç°åŸç†ä¹ˆï¼Ÿ"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://dapengdouyu.github.io/docs/books/babel/19ã€å®æˆ˜æ¡ˆä¾‹: å‹ç¼©æ··æ·†"><link data-react-helmet="true" rel="alternate" href="https://dapengdouyu.github.io/docs/books/babel/19ã€å®æˆ˜æ¡ˆä¾‹: å‹ç¼©æ··æ·†" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://dapengdouyu.github.io/docs/books/babel/19ã€å®æˆ˜æ¡ˆä¾‹: å‹ç¼©æ··æ·†" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.5ab70b72.css">
<link rel="preload" href="/assets/js/runtime~main.3c5dc381.js" as="script">
<link rel="preload" href="/assets/js/main.055808b2.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.jpg" alt="DAPENG" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.jpg" alt="DAPENG" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">DAPENG</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">åšå®¢</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/tags/java-script">JavaScript</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link">å‰ç«¯</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/program/javascript/index">Javascript</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link">é˜…è¯»</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/books/babel/index">babel</a></li></ul></div><a href="https://github.com/dapengdouyu" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>gitee<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ğŸŒ</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><main class="docMainContainer_3ufF docMainContainerEnhanced_3NYZ"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1 class="h1Heading_27L5">19ã€å®æˆ˜æ¡ˆä¾‹: å‹ç¼©æ··æ·†</h1></header><p>å‹ç¼©æ··æ·†å·¥å…·æ˜¯å‰ç«¯å¿…ç”¨çš„å·¥å…·ä¹‹ä¸€ï¼Œä»£ç åœ¨ä¸Šçº¿ä¹‹é—´éœ€è¦ç»è¿‡å‹ç¼©æ¥å‡å°ä½“ç§¯ï¼Œå¹¶ä¸”ä¼šåšä¸€äº›ç®€å•çš„æ··æ·†æ¥é˜²æ­¢æºç ç›´æ¥æ³„æ¼ã€‚å‰ç«¯å·¥ç¨‹å¸ˆå¯èƒ½æ¯å¤©éƒ½åœ¨ç”¨è¿™ç§å·¥å…·ï¼Œå¯ä½ æœ‰æƒ³è¿‡å®ƒçš„å®ç°åŸç†ä¹ˆï¼Ÿ</p><p>ä»£ç çš„å‹ç¼©å’Œæ··æ·†éƒ½æ˜¯å¯¹ä»£ç åšè½¬æ¢ï¼Œä½†æ˜¯è½¬æ¢å‰åè¦ä¿æŒè¯­ä¹‰ä¸€è‡´ï¼Œå°±æ˜¯ä¸èƒ½è½¬å®Œä¹‹åä»£ç é€»è¾‘æ”¹å˜äº†ã€‚ä¹‹æ‰€ä»¥èƒ½åšè¿™äº›è½¬æ¢æ˜¯å› ä¸ºè®¡ç®—æœºæ‰§è¡Œä»£ç å¹¶ä¸éœ€è¦æ¢è¡Œã€ä¹Ÿä¸éœ€è¦å˜é‡åå¤šä¹ˆæ˜“æ‡‚ï¼Œé‚£éƒ½æ˜¯ç»™äººçœ‹çš„ï¼Œå¯ä»¥ç®€åŒ–æ‰ï¼Œè€Œä¸”æœ‰çš„ä¸ä¼šè¢«æ‰§è¡Œåˆ°çš„ä»£ç ä¹Ÿå¯ä»¥åˆ æ‰ã€‚å‹ç¼©å’Œæ··æ·†å°±æ˜¯åˆ†æä»£ç ä¸­çš„è¿™ç§ä»£ç ï¼Œè¿›è¡Œåˆ†æå’Œè½¬æ¢ï¼Œè¾¾åˆ°è½¬æ¢å‰åæ‰§è¡Œé€»è¾‘ä¸€è‡´ï¼Œä½†æ˜¯ä»£ç ä½“ç§¯æ›´å°ã€å¯è¯»æ€§æ›´å·®çš„ç›®çš„ã€‚</p><p>æˆ‘ä»¬åˆ†åˆ«æ¥å®ç°ä¸€ä¸‹å‹ç¼©å’Œæ··æ·†ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ··æ·†"></a>æ··æ·†<a class="hash-link" href="#æ··æ·†" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ€è·¯åˆ†æ"></a>æ€è·¯åˆ†æ<a class="hash-link" href="#æ€è·¯åˆ†æ" title="Direct link to heading">#</a></h3><p>æ··æ·†å°±æ˜¯æŠŠä»£ç å˜å¾—éš¾ä»¥é˜…è¯»ï¼Œè®©æ€€æœ‰æ¶æ„ç›®çš„çš„äººå¾ˆéš¾é€šè¿‡ä»£ç ç†æ¸…é€»è¾‘ï¼Œä½†æ˜¯ä¸èƒ½æ”¹å˜æ‰§è¡Œçš„ç»“æœã€‚è¦åšç­‰ä»·è½¬æ¢ã€‚</p><p>è¿™ç§è½¬æ¢åŒ…æ‹¬ä¸¤æ–¹é¢ï¼š</p><ul><li><p>åå­—è½¬æ¢ã€‚å˜é‡åã€å‡½æ•°åè¿™äº›æˆ‘ä»¬ä¼šæ³¨æ„å‘½åè¦æœ‰å«ä¹‰ï¼Œä½†æ˜¯ç¼–è¯‘åçš„ä»£ç å°±ä¸éœ€è¦äº†ï¼Œå¯ä»¥æŠŠå„ç§ identifier çš„ name é‡å‘½åä¸ºæ²¡æœ‰å«ä¹‰çš„ abcdï¼Œè¿™ä¸ªå¯ä»¥é€šè¿‡ path.scope.rename çš„ api æ¥åšåˆ°ã€‚</p></li><li><p>é€»è¾‘è½¬æ¢ã€‚if çš„é€»è¾‘å¯ä»¥ç”¨ switch æ¥ä»£æ›¿ï¼Œfor çš„é€»è¾‘å¯ä»¥ç”¨ while æ¥ä»£æ›¿ï¼Œè¿™éƒ½æ˜¯ç­‰ä»·çš„ï¼ŒæŠŠä¸€ç§æ–¹å¼å®ç°çš„ä»£ç è½¬æˆå¦ä¸€ç§ç­‰ä»·çš„å½¢å¼å°±å¯ä»¥è¾¾åˆ°æ··æ·†çš„ç›®çš„ã€‚åšæ··æ·†å·¥å…·ä¸»è¦æ˜¯è¦æ‰¾åˆ°è¿™ç§ç­‰ä»·çš„å˜åŒ–ï¼Œè€Œä¸”åè€…ä¸€å®šè¦ç‰¹åˆ«å¤æ‚éš¾ä»¥åˆ†æï¼Œç„¶åå®ç°è¿™ç§è½¬æ¢ï¼Œå°±è¾¾åˆ°äº†æ··æ·†çš„ç›®çš„ã€‚</p></li></ul><p>è¿™é‡Œæˆ‘ä»¬åªå®ç°ä¸‹åå­—çš„æ··æ·†ã€‚</p><p>ç›®çš„æ˜¯ä¸ºäº†æ‰¾å‡ºæ‰€æœ‰çš„å£°æ˜ï¼Œé‚£å°±è¦éå†æ‰€æœ‰ä¼šç”Ÿæˆä½œç”¨åŸŸçš„èŠ‚ç‚¹ï¼ŒåŒ…æ‹¬ FunctionDeclarationã€BlockStatement ç­‰ï¼Œè€Œè¿™äº›èŠ‚ç‚¹åˆä¸€ä¸ªåˆ«åï¼Œå« Scopableï¼ˆæ‰€æœ‰çš„åˆ«åå¯ä»¥åœ¨<a href="https://github.com/babel/babel/blob/main/packages/babel-types/src/ast-types/generated/index.ts#L2489-L2535" target="_blank" rel="noopener noreferrer">è¿™é‡Œ</a>æŸ¥ï¼Œè¯¦è§ç¬¬ä¸ƒèŠ‚ï¼‰ï¼Œç„¶åå¯¹æ¯ä¸€ä¸ªå£°æ˜ï¼ˆbindingï¼‰éƒ½é‡å‘½åä¸ºæ— æ„ä¹‰çš„åå­—ï¼Œå¹¶ä¸”æ›´æ–°æ‰€æœ‰å¼•ç”¨è¿™ä¸ªå£°æ˜çš„åœ°æ–¹ï¼Œè¿™ä¸ªé€»è¾‘åœ¨ path.scope.rename å·²ç»å®ç°äº†ï¼Œç›´æ¥è°ƒç”¨è¿™ä¸ª api å³å¯ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ä»£ç å®ç°"></a>ä»£ç å®ç°<a class="hash-link" href="#ä»£ç å®ç°" title="Direct link to heading">#</a></h3><p>ä¾ç„¶å…ˆå†™å¥½æ’ä»¶çš„ç»“æ„ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> declare </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;@babel/helper-plugin-utils&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> mangle </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">declare</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">api</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> options</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> dirname</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">assertVersion</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">pre</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">file</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            file</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;uid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        visitor</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token maybe-class-name">Scopable</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> mangle</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>è¿™é‡Œåœ¨ file æ”¾äº†ä¸€ä¸ª uid æ˜¯ä¸ºäº†è·å–å”¯ä¸€ id çš„ï¼Œåé¢ä¼šç”¨åˆ°ã€‚</p><p>æˆ‘ä»¬åŸºäºè¿™ä¸ª uid æ¥è·å–å”¯ä¸€çš„åå­—ï¼Œå› ä¸ºä¸èƒ½ä»¥æ•°å­—å¼€å¤´ï¼Œæ‰€ä»¥ç”¨ A-Zã€a-zã€$ å’Œ _ è¿™ 54 ä¸ªå­—ç¬¦æ¥ç”Ÿæˆã€‚</p><p>æ ¹æ®ä¼ å…¥çš„ num æ¥å–å¯¹åº”ä¸‹æ ‡çš„å­—ç¬¦ç»„æˆå­—ç¬¦ä¸²ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> base54 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">DIGITS</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$_&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">num</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> ret </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword control-flow" style="color:#00009f">do</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">                    ret </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">DIGITS</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">charAt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">54</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> ret</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">                    num </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">floor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">54</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> ret</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ç„¶åå°±æ˜¯æ›¿æ¢æ‰€æœ‰çš„å£°æ˜ï¼ˆbindingï¼‰ çš„åå­—äº†ï¼š</p><p>é¦–å…ˆå–å‡º path.scope.bindingsï¼Œéå†æ¯ä¸€ä¸ª bindingï¼Œç„¶åé€šè¿‡ rename çš„ api æ¥è¿›è¡Œæ”¹åã€‚</p><p>å¹¶ä¸”å¤„ç†è¿‡åçš„å£°æ˜åŠ ä¸ªæ ‡è®°ï¼Œå†æ¬¡å¤„ç†åˆ°çš„æ—¶å€™å°±è·³è¿‡ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token maybe-class-name">Scopable</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">path</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> uid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">file</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;uid&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">entries</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">scope</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">bindings</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">forEach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">[</span><span class="token parameter">key</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> binding</span><span class="token parameter punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">binding</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">mangled</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            binding</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">mangled</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> newName </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">scope</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">generateUid</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">base54</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">uid</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            binding</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">scope</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">rename</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> newName</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">file</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;uid&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> uid</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>è¯•ä¸‹æ•ˆæœï¼Œå½“è¾“å…¥ä»£ç ä¸ºï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> num1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> num2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> num3 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/*@__PURE__*/</span><span class="token function" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> num4 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> num2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">aaa</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> bbb</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> aaa </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> bbb</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">func</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>è¾“å‡ºä¸ºï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/596e2ff12a5b426e9ff0665cee7827a6~tplv-k3u1fbpfcp-watermark.image"></p><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å®ç°äº†å˜é‡åçš„æ··æ·†ï¼</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="å‹ç¼©"></a>å‹ç¼©<a class="hash-link" href="#å‹ç¼©" title="Direct link to heading">#</a></h2><p>å‹ç¼©å°±æ˜¯è¦å»æ‰ä»£ç ä¸­æ‰§è¡Œä¸åˆ°çš„éƒ¨åˆ†ï¼Œæ¯”å¦‚ return è¯­å¥åçš„ä¸€äº›è¯­å¥å’Œæ²¡æœ‰æ„ä¹‰çš„éƒ¨åˆ†ï¼Œæ¯”å¦‚æ³¨é‡Šã€æ¢è¡Œç­‰ã€‚</p><p>åŸºäº AST çš„è½¬æ¢åšå‹ç¼©è¦å¤„ç†çš„æƒ…å†µç‰¹åˆ«å¤šï¼Œè¿™é‡Œæˆ‘ä»¬åªå®ç°ä¸¤ç§æƒ…å†µçš„å‹ç¼©ï¼š</p><ul><li>åˆ é™¤ return ä¹‹åçš„ä¸ä¼šæ‰§è¡Œåˆ°çš„è¯­å¥</li><li>åˆ é™¤æ²¡æœ‰è¢«ä½¿ç”¨çš„å˜é‡å£°æ˜ï¼ˆæ­»ä»£ç åˆ é™¤ Dead Code Elemationï¼Œç®€ç§° DCEï¼‰</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="åˆ é™¤-return-ä¹‹åçš„è¯­å¥"></a>åˆ é™¤ return ä¹‹åçš„è¯­å¥<a class="hash-link" href="#åˆ é™¤-return-ä¹‹åçš„è¯­å¥" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ€è·¯åˆ†æ-1"></a>æ€è·¯åˆ†æ<a class="hash-link" href="#æ€è·¯åˆ†æ-1" title="Direct link to heading">#</a></h4><p>åˆ é™¤ return ä¹‹åçš„è¯­å¥ï¼Œå°±æ˜¯è¦æ‰¾åˆ°å‡½æ•°å£°æ˜ FunctionDeclaration çš„å‡½æ•°ä½“ï¼Œéå†ä¸€é body çš„ ASTï¼Œå¦‚æœæ˜¯ return ä¹‹åå°±æ‰“ä¸ªæ ‡è®°ä¹‹ååˆ é™¤ã€‚</p><p>ä½†æ˜¯è¦æ³¨æ„ï¼Œreturn ä¹‹åæ˜¯å¯ä»¥æœ‰å‡½æ•°å£°æ˜çš„ï¼Œä¼šåšå˜é‡æå‡ï¼Œè¿˜æœ‰å¦‚æœæ˜¯ var å£°æ˜çš„å˜é‡ï¼Œä¹Ÿä¼šåšæå‡ï¼Œæ‰€ä»¥è¦å»æ‰è¿™ä¸¤ç§æƒ…å†µã€‚</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ä»£ç å®ç°-1"></a>ä»£ç å®ç°<a class="hash-link" href="#ä»£ç å®ç°-1" title="Direct link to heading">#</a></h4><p>æ‹¿åˆ° BlockStatement çš„ body ä¸­çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¦‚æœæ˜¯åœ¨ returnã€throw ç­‰è¯­å¥ä¹‹åï¼Œå°±å‡†å¤‡åˆ é™¤ï¼Œä½†æ˜¯è¦æ’é™¤å‡½æ•°å£°æ˜è¯­å¥å’Œ var çš„å˜é‡å£°æ˜è¯­å¥ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function maybe-class-name" style="color:#d73a49">BlockStatement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> statementPaths </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;body&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> purge </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> statementPaths</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">statementPaths</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">isCompletionStatement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            purge </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword control-flow" style="color:#00009f">continue</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">purge </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token function" style="color:#d73a49">canExistAfterCompletion</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">statementPaths</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            statementPaths</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">remove</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>è¿™é‡Œçš„ CompletionStatement å¯ä»¥é€šè¿‡å‰é¢æåˆ°çš„ alias æ¥æŸ¥ï¼Œ CompletionStatement ä¹Ÿæ˜¯ä¸€ä¸ªåˆ«åã€‚</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8bd81f8022394c8999ff9f4e5b68428b~tplv-k3u1fbpfcp-watermark.image"></p><p>ç„¶ååˆ¤æ–­æ˜¯å¦å¯ä»¥åˆ é™¤çš„ canExistAfterCompletion æ–¹æ³•æ˜¯ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">canExistAfterCompletion</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">isFunctionDeclaration</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">isVariableDeclaration</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        kind</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;var&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>æµ‹è¯•ä¸‹æ•ˆæœï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bd80d95d600d4526940da936e91071cf~tplv-k3u1fbpfcp-watermark.image"></p><p>è¿™æ ·å°±è¾¾åˆ°äº†åˆ é™¤ä¸ä¼šæ‰§è¡Œåˆ°çš„ä»£ç çš„ç›®çš„ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="åˆ é™¤æ²¡è¢«ä½¿ç”¨çš„å˜é‡å£°æ˜"></a>åˆ é™¤æ²¡è¢«ä½¿ç”¨çš„å˜é‡å£°æ˜<a class="hash-link" href="#åˆ é™¤æ²¡è¢«ä½¿ç”¨çš„å˜é‡å£°æ˜" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ€è·¯åˆ†æ-2"></a>æ€è·¯åˆ†æ<a class="hash-link" href="#æ€è·¯åˆ†æ-2" title="Direct link to heading">#</a></h4><p>å˜é‡å£°æ˜ä¹Ÿå°±æ˜¯ path.scope ä¸­çš„ bindingï¼Œå¯ä»¥é€šè¿‡ references çš„æ•°é‡æˆ–è€… referenced æ˜¯å¦æ˜¯ true æ¥åˆ¤æ–­æ˜¯å¦è¢«å¼•ç”¨ï¼Œå¦‚æœæ²¡æœ‰è¢«å¼•ç”¨ï¼Œé‚£ä¹ˆå°±å¯ä»¥åˆ é™¤ã€‚</p><p>ä½†æ˜¯è¿™é‡Œä¹Ÿæœ‰ç§ç‰¹æ®Šæƒ…å†µï¼Œå°±æ˜¯å¦‚æœåˆå§‹åŒ–çš„å€¼æ˜¯å‡½æ•°è°ƒç”¨ï¼Œé‚£ä¹ˆå°±ä¸èƒ½ç›´æ¥åˆ é™¤ï¼Œå› ä¸ºå¯èƒ½æœ‰å‰¯ä½œç”¨ï¼Œæ¯”å¦‚ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> a </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;aa&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> b </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">a</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>è¿™é‡Œçš„ b æ²¡æœ‰è¢«ç”¨åˆ°ï¼Œä½†æ˜¯è¿™ä¸ª a() çš„å‡½æ•°è°ƒç”¨å´ä¸èƒ½ç›´æ¥åˆ é™¤ï¼Œå› ä¸ºæ˜¯æœ‰å‰¯ä½œç”¨çš„ï¼Œåªèƒ½è½¬æˆè¿™ç§ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> a </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;a&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;aa&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">a</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>åªæŠŠå£°æ˜çš„å˜é‡å»æ‰ï¼Œä½†æ˜¯ä¿ç•™å‡½æ•°è°ƒç”¨è¯­å¥ã€‚</p><p>é‚£ä¹ˆå¦‚æœè¯¥èŠ‚ç‚¹ç¡®å®æ²¡æœ‰å‰¯ä½œç”¨æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><p>babel æä¾›äº†ä¸€ä¸ª path.scope.isPure çš„ apiï¼Œå¯ä»¥åˆ¤æ–­ä¸€äº› AST èŠ‚ç‚¹æ˜¯å¦æ˜¯çº¯çš„ï¼Œä¹Ÿå°±æ˜¯æ˜¯å¦æ˜¯æ²¡æœ‰å‰¯ä½œç”¨çš„ï¼Œå¯ä»¥åˆ¤æ–­å„ç§ AST æ˜¯å¦å¯ä»¥æ”¾å¿ƒçš„åˆ é™¤ã€‚</p><p>ä½†æ˜¯å‡½æ•°è°ƒç”¨ä»–æ˜¯åˆ†æä¸äº†çš„ï¼Œå¯ä»¥é‡‡ç”¨ terser çš„æ–¹æ¡ˆï¼Œé€šè¿‡æ³¨é‡Šæ¥æ ‡æ³¨çº¯å‡½æ•°ã€‚</p><p>å¤§å®¶å¯èƒ½è§åˆ°è¿‡è¿™æ ·çš„ä»£ç ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/*#__PURE__*/</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">creatElement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;div&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>è¿™é‡Œçš„ pure æ³¨é‡Šå°±æ˜¯å‘Šè¯‰ terser è¿™ä¸ªå‡½æ•°æ²¡æœ‰å‰¯ä½œç”¨ï¼Œå¦‚æœæ²¡ç”¨åˆ°å°±ç›´æ¥åˆ é™¤å°±è¡Œã€‚</p><p>æˆ‘ä»¬è¿™é‡Œä¹Ÿé‡‡ç”¨ç›¸åŒçš„æ–¹æ¡ˆï¼Œå¦‚æœå‡½æ•°è°ƒç”¨ä¹‹å‰æœ‰ PURE æ³¨é‡Šï¼Œåˆ™ç›´æ¥åˆ é™¤ï¼Œå¦åˆ™ä¿ç•™ã€‚</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ä»£ç å®ç°-2"></a>ä»£ç å®ç°<a class="hash-link" href="#ä»£ç å®ç°-2" title="Direct link to heading">#</a></h4><p>é¦–å…ˆæ‹¿åˆ°æ¯ä¸€ä¸ª bindingï¼Œåˆ¤æ–­ä¸‹æœ‰æ²¡æœ‰è¢«å¼•ç”¨ã€‚</p><p>å¦‚æœæ²¡æœ‰è¢«å¼•ç”¨ï¼Œé‚£å°±åˆ¤æ–­ä¸‹åˆå§‹åŒ–å€¼æ˜¯å¦æ˜¯å‡½æ•°è°ƒç”¨è¯­å¥ï¼Œå¦‚æœæ˜¯ï¼Œè¿˜è¦åˆ¤æ–­æœ‰æ²¡æœ‰ PURE çš„æ³¨é‡Šï¼Œæœ‰å°±ç›´æ¥åˆ ã€‚</p><p>ç„¶åç”¨ isPure åˆ¤æ–­èŠ‚ç‚¹æ˜¯å¦æ˜¯æ²¡æœ‰å‰¯ä½œç”¨çš„ï¼Œæ¯”å¦‚ StringLiteralã€Identifer è¿™ç§å°±æ²¡å‰¯ä½œç”¨ï¼Œå¯ä»¥ç›´æ¥åˆ é™¤ã€‚å¦åˆ™å°±ä¿ç•™å³è¾¹çš„éƒ¨åˆ†ï¼ŒæŠŠå£°æ˜åˆ é™¤ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function maybe-class-name" style="color:#d73a49">Scopable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">entries</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">scope</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">bindings</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">forEach</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">[</span><span class="token parameter">key</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> binding</span><span class="token parameter punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">binding</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">referenced</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token comment" style="color:#999988;font-style:italic">//æ²¡æœ‰è¢«å¼•ç”¨</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">binding</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;init&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">isCallExpression</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> comments </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> binding</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;init&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">node</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">leadingComments</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">//æ‹¿åˆ°èŠ‚ç‚¹å‰çš„æ³¨é‡Š</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">comments </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> comments</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">comments</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">includes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;PURE&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token comment" style="color:#999988;font-style:italic">//æœ‰ PURE æ³¨é‡Šå°±åˆ é™¤</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">                            binding</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">remove</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">                            </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">scope</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">isPure</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">binding</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">node</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">init</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token comment" style="color:#999988;font-style:italic">//å¦‚æœæ˜¯çº¯çš„ï¼Œå°±ç›´æ¥åˆ é™¤ï¼Œå¦åˆ™æ›¿æ¢ä¸ºå³è¾¹éƒ¨åˆ†</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">                    binding</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">parentPath</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">replaceWith</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">api</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">types</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">expressionStatement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">binding</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">node</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">init</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">                    binding</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">remove</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>è¯•ä¸‹æ•ˆæœï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e8294becd00341c9b0d4e9b22f2ab25e~tplv-k3u1fbpfcp-watermark.image"></p><p>å¦‚å›¾ï¼Œnum3 å’Œ num4 éƒ½æ²¡æœ‰è¢«ä½¿ç”¨ï¼Œä½†æ˜¯ num3å› ä¸ºæ ‡è®°äº† PUREï¼Œæ‰€ä»¥å½“ä½œçº¯å‡½æ•°åˆ é™¤äº†ï¼Œè€Œ num4 åˆ™ä¿ç•™äº†è¯¥å‡½æ•°è°ƒç”¨ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ•ˆæœæ¼”ç¤º"></a>æ•ˆæœæ¼”ç¤º<a class="hash-link" href="#æ•ˆæœæ¼”ç¤º" title="Direct link to heading">#</a></h2><p>æˆ‘ä»¬æŠŠå‹ç¼©å’Œæ··æ·†çš„åŠŸèƒ½æ•´ä½“è·‘ä¸€ä¸‹:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> transformFromAstSync </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;@babel/core&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain">  parser </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;@babel/parser&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> manglePlugin </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;./plugin/mangle&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> compressPlugin </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;./plugin/compress&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> sourceCode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c"></span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">    function func() {</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">        const num1 = 1;</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">        const num2 = 2;</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">        const num3 = /*@__PURE__*/add(1, 2);</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">        const num4 = add(3, 4);</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">        console.log(num2);</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">        return num2;</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">        console.log(num1);</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">        function add (aaa, bbb) {</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">            return aaa + bbb;</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">        }</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">    }</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">    func();</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c"></span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> ast </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> parser</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sourceCode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    sourceType</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;unambiguous&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    comments</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> code </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">transformFromAstSync</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ast</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sourceCode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    plugins</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">manglePlugin</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">compressPlugin</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    generatorOpts</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        comments</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        compact</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">code</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>æ•ˆæœä¸ºï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a1edefa3de4b4cb9939cf795918514a1~tplv-k3u1fbpfcp-watermark.image"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ€»ç»“"></a>æ€»ç»“<a class="hash-link" href="#æ€»ç»“" title="Direct link to heading">#</a></h2><p>å‹ç¼©æ··æ·†ä¹Ÿæ˜¯å¯¹ä»£ç åšè½¬æ¢ï¼Œä½†æ˜¯åšçš„æ˜¯ç­‰ä»·è½¬æ¢ï¼Œå˜é‡åæ¢æˆæ— æ„ä¹‰çš„åå­—ï¼Œä»£ç ç»“æ„è½¬æˆæ›´éš¾è¯»ä½†æ˜¯æ‰§è¡Œæ•ˆæœä¸€æ ·çš„å½¢å¼ï¼Œæ²¡ç”¨åˆ°çš„ä»£ç ï¼ˆreturn åçš„ã€æ²¡è¢«å¼•ç”¨çš„å£°æ˜ï¼‰åˆ é™¤æ‰ã€‚ç­‰ç­‰ã€‚</p><p>å…·ä½“çš„ case å¯èƒ½å¾ˆå¤šï¼Œä½†æ˜¯æ€è·¯å’Œç›®çš„éƒ½æ˜¯ä¸€è‡´çš„ï¼Œå°±æ˜¯åœ¨ç­‰ä»·çš„å‰æä¸‹ï¼Œè®©ä»£ç ä½“ç§¯æ›´å°ï¼Œå¯è¯»æ€§æ›´å·®ã€‚</p><p>æœ‰äº›è¦å¯¹ä»£ç åšä¿æŠ¤çš„åœºæ™¯æ˜¯è¦è‡ªå·±åšæ··æ·†çš„å®ç°çš„ï¼Œå°±æ˜¯è¦æ‰¾å„ç§ç­‰ä»·çš„å½¢å¼ï¼Œç„¶åå®ç°è½¬æ¢ã€‚é™¤äº†è¿™ä¸ªä¹‹å¤–ï¼Œäº†è§£å‹ç¼©æ··æ·†çš„åŸç†ä¹Ÿå¯ä»¥è®©æˆ‘ä»¬æ›´å¥½çš„ä½¿ç”¨ç±»ä¼¼å·¥å…·ï¼Œæ¯”å¦‚ terserã€‚</p><p>ï¼ˆä»£ç åœ¨<a href="https://github.com/QuarkGluonPlasma/babel-plugin-exercize" target="_blank" rel="noopener noreferrer">è¿™é‡Œ</a>ï¼Œå»ºè®® git clone ä¸‹æ¥é€šè¿‡ node è·‘ä¸€ä¸‹ï¼‰</p></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/dapengdouyu/docs/tree/master/docs/books/babel/19ã€å®æˆ˜æ¡ˆä¾‹: å‹ç¼©æ··æ·†.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF">Last updated on <b><time datetime="2021-10-09T09:56:52.000Z">10/9/2021</time></b></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#æ··æ·†" class="table-of-contents__link">æ··æ·†</a><ul><li><a href="#æ€è·¯åˆ†æ" class="table-of-contents__link">æ€è·¯åˆ†æ</a></li><li><a href="#ä»£ç å®ç°" class="table-of-contents__link">ä»£ç å®ç°</a></li></ul></li><li><a href="#å‹ç¼©" class="table-of-contents__link">å‹ç¼©</a><ul><li><a href="#åˆ é™¤-return-ä¹‹åçš„è¯­å¥" class="table-of-contents__link">åˆ é™¤ return ä¹‹åçš„è¯­å¥</a></li><li><a href="#åˆ é™¤æ²¡è¢«ä½¿ç”¨çš„å˜é‡å£°æ˜" class="table-of-contents__link">åˆ é™¤æ²¡è¢«ä½¿ç”¨çš„å˜é‡å£°æ˜</a></li></ul></li><li><a href="#æ•ˆæœæ¼”ç¤º" class="table-of-contents__link">æ•ˆæœæ¼”ç¤º</a></li><li><a href="#æ€»ç»“" class="table-of-contents__link">æ€»ç»“</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 dapeng (å¼ äºšé¹) Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.3c5dc381.js"></script>
<script src="/assets/js/main.055808b2.js"></script>
</body>
</html>