<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.7">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="Dapeng&#39;s blog RSS Feed">
<script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?7dda2565ba246ecd62878c13153e2941",e.defer=!0;var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
<meta name="baidu-site-verification" content="IXU12YQUjF">
<link rel="preconnect" href="https://hmcdn.baidu.com">
<link rel="stylesheet" href="https://cansiny.oss-cn-shanghai.aliyuncs.com/assets/fonts.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><title data-react-helmet="true">实战篇 8：小程序调试技巧和上线发布 - Dapeng的博客</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://dapengdouyu.github.io/docs/books/微信小程序开发入门：从 0 到 1 实现天气小程序/实战篇 8：小程序调试技巧和上线发布"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="实战篇 8：小程序调试技巧和上线发布 - Dapeng的博客"><meta data-react-helmet="true" name="description" content="真机调试"><meta data-react-helmet="true" property="og:description" content="真机调试"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://dapengdouyu.github.io/docs/books/微信小程序开发入门：从 0 到 1 实现天气小程序/实战篇 8：小程序调试技巧和上线发布"><link data-react-helmet="true" rel="alternate" href="https://dapengdouyu.github.io/docs/books/微信小程序开发入门：从 0 到 1 实现天气小程序/实战篇 8：小程序调试技巧和上线发布" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://dapengdouyu.github.io/docs/books/微信小程序开发入门：从 0 到 1 实现天气小程序/实战篇 8：小程序调试技巧和上线发布" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.104602c4.css">
<link rel="preload" href="/assets/js/runtime~main.0460df01.js" as="script">
<link rel="preload" href="/assets/js/main.1f72a20d.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.jpg" alt="DAPENG" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/logo.jpg" alt="DAPENG" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">DAPENG</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link" href="/">博客</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/tags/java-script">JavaScript</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link">前端</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/program/javascript/index">Javascript</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link">阅读</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/books/Babel 插件通关秘籍/index">Babel 插件通关秘籍</a></li></ul></div><a href="https://github.com/dapengdouyu" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">🌜</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">🌞</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Babel 插件通关秘籍</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">MySQL 是怎样运行的：从根儿上理解 MySQL</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">React Hooks 与 Immutable 数据流实战</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">React 组合式开发实践：打造企业管理系统五大核心模块</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">React实战：设计模式和最佳实践</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Taro 多端开发实现原理与项目实战</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">前端性能优化原理与实践</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">前端面试之道</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">微信小程序开发入门：从 0 到 1 实现天气小程序</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/books/微信小程序开发入门：从 0 到 1 实现天气小程序/index">index</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/books/微信小程序开发入门：从 0 到 1 实现天气小程序/基础篇 1：小程序开发基础知识">基础篇 1：小程序开发基础知识</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/books/微信小程序开发入门：从 0 到 1 实现天气小程序/基础篇 2：小程序云开发基础知识">基础篇 2：小程序·云开发基础知识</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/books/微信小程序开发入门：从 0 到 1 实现天气小程序/基础篇 3：小程序架构及其实现机制">基础篇 3：小程序架构及其实现机制</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/books/微信小程序开发入门：从 0 到 1 实现天气小程序/实战篇 1：小程序开发环境搭建">实战篇 1：小程序开发环境搭建</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/books/微信小程序开发入门：从 0 到 1 实现天气小程序/实战篇 2：新鲜天气小程序简介">实战篇 2：新鲜天气小程序简介</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/books/微信小程序开发入门：从 0 到 1 实现天气小程序/实战篇 3：天气页面样式布局开发">实战篇 3：天气页面样式布局开发</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/books/微信小程序开发入门：从 0 到 1 实现天气小程序/实战篇 4：天气页面数据获取和交互实现">实战篇 4：天气页面数据获取和交互实现</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/books/微信小程序开发入门：从 0 到 1 实现天气小程序/实战篇 5：为天气页面制作雨雪效果的粒子系统">实战篇 5：为天气页面制作雨雪效果的粒子系统</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/books/微信小程序开发入门：从 0 到 1 实现天气小程序/实战篇 6：心情签到页面开发">实战篇 6：心情签到页面开发</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/books/微信小程序开发入门：从 0 到 1 实现天气小程序/实战篇 7：对小程序进行优化">实战篇 7：对小程序进行优化</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/books/微信小程序开发入门：从 0 到 1 实现天气小程序/实战篇 8：小程序调试技巧和上线发布">实战篇 8：小程序调试技巧和上线发布</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/books/微信小程序开发入门：从 0 到 1 实现天气小程序/开篇：微信小程序概述">开篇：微信小程序概述</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/books/微信小程序开发入门：从 0 到 1 实现天气小程序/总结与拓展">总结与拓展</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">正则表达式</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">深入浅出TypeScript：从基础知识到类型编程</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_1CGd"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_3E-R"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>实战篇 8：小程序调试技巧和上线发布</h1></header><h2 class="anchor anchorWithStickyNavbar_31ik" id="真机调试">真机调试<a aria-hidden="true" class="hash-link" href="#真机调试" title="Direct link to heading">​</a></h2><p>平时开发小程序可以在开发者工具中进行调试，开发者工具提供了类似 Chrome DevTools 的调试面板，对于前端开发者来说入门门槛比较低。</p><p>小程序开发完成之后，我们需要在真机上进行测试，真机调试方面小程序开发者工具有<strong>预览</strong>、<strong>远程调试</strong>和<strong>设置体验版本</strong>三大部分功能。除了这三种方式之外，我们还可以使用真机远程调试，在 iOS 上可以通过实现 Safari 调试代码，安卓中可以安装 X5 内核的 inspect 版本，开启 Chrome remote debug 模式。</p><p>本部分会简单介绍开发者工具的预览和远程调试功能，以及如何开启 iOS 和 Android 的真机调试功能，体验版本功能会在「上线」部分讲解。</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="预览功能">预览功能<a aria-hidden="true" class="hash-link" href="#预览功能" title="Direct link to heading">​</a></h3><p>在开发者工具中，顶部有「预览」功能，点击后会编译打包当前代码，然后生成一个二维码，用开发者账号扫码就可以预览代码。当遇见问题需要同步编写代码 debug 的时候，可以切换到「自动预览」模式，如下图所示，只要代码发生变化就会重新编译自动启动小程序。</p><p><img src="https://user-gold-cdn.xitu.io/2018/8/15/1653c204eeca9fe4?w=275&amp;h=468&amp;f=jpeg&amp;s=28449"></p><h3 class="anchor anchorWithStickyNavbar_31ik" id="远程调试">远程调试<a aria-hidden="true" class="hash-link" href="#远程调试" title="Direct link to heading">​</a></h3><p>远程调试也是在开发者工具中开启的，点击顶部的「远程调试」即出现跟预览功能类似的界面，打包上传之后也会出现一个二维码，通过扫码可以进入远程调试界面。这时候，手机会打开带有 <a href="https://github.com/Tencent/vConsole" target="_blank" rel="noopener noreferrer">vConsole</a> 的小程序界面，而开发者工具的电脑则显示一个类似 Chrome DevTools 的开发者调试工具。这样就可以直接调试了。</p><p><img src="https://user-gold-cdn.xitu.io/2018/8/17/16546a63a85ac9bb?w=750&amp;h=1334&amp;f=png&amp;s=534782"></p><p><img src="https://user-gold-cdn.xitu.io/2018/8/17/16546aac4dd9cbab?w=1136&amp;h=934&amp;f=jpeg&amp;s=140192"></p><h3 class="anchor anchorWithStickyNavbar_31ik" id="ios-调试">iOS 调试<a aria-hidden="true" class="hash-link" href="#ios-调试" title="Direct link to heading">​</a></h3><p>下面介绍下如何使用 Xcode、Reveal 和 Safari 来真机调试 iOS 上的小程序。进行 iOS 调试需要使用 Mac 电脑，如果你用的是 Windows 系统，可以跳过本部分内容，直接查看后面的 Android 版本的 remote debug。</p><blockquote><p>先大概说下原理，首先下载砸过壳版本的微信 ipa 文件（iOS App 程序的后缀），然后使用 IPAPatch 对 ipa 进行重新签名，签名账号可以使用自己的 Apple 账号，最后将项目编译到真机（也可以模拟器），就可以使用 Safari 进行调试了。</p></blockquote><ol><li>下载 <a href="https://github.com/Naituw/IPAPatch" target="_blank" rel="noopener noreferrer">IPAPatch 项目</a></li><li>使用 PP 助手下载砸过壳版本的微信 ipa（使用最新版本的微信，否则登录会提示需要升级），这个需要安装 PP 助手，下载后在下载目录找到其 ipa</li><li>将微信的 ipa 文件命名为 app.ipa，替换掉 IPAPatch 目录的 Assets/app.ipa 文件</li><li>使用 Xcode 打开 IPAPatch 项目</li><li>修改签名到自己的开发者账号，没有开发者账号可以用自己的 Apple 账号登录</li></ol><p><img src="https://user-gold-cdn.xitu.io/2018/8/15/1653c20e1452b7a0?w=1512&amp;h=887&amp;f=jpeg&amp;s=205377"></p><p>按照上面的提示，首先修改 <code>BundleID</code>（这里的填写可以比较随意），然后使用自己的 Apple ID 登录账号，再选择自己的真机（数据线连接后可以选择），选择后点击开始编译，编译结束会安装到自己的 iPhone 手机，安装成功后就会发现自己的手机有两个微信了。</p><p>接着再完成下面的步骤，就可以调试小程序了。</p><ol><li>在 iPhone 上信任自己的开发者描述文件：「设置 -&gt; 通用 -&gt; 描述文件 -&gt; 信任你的证书」</li><li>在 iPhone 上打开 Safari 调试功能：「设置 -&gt; Safari -&gt; 高级 -&gt; Web 检查器打开」</li></ol><p>首先登录微信账号，打开需要调试的小程序，打开后在 Mac 电脑上打开「Safari -&gt; 开发」找到自己的 iPhone 手机，选择对应的页面就可以进行调试了。</p><p><img src="https://user-gold-cdn.xitu.io/2018/8/15/1653c21423b68206?w=692&amp;h=242&amp;f=jpeg&amp;s=54346"></p><p>这里说明下：</p><ul><li>JSContext：是小程序的逻辑层代码，执行在 JavaScriptCore 环境中</li><li>page-frame.html：是小程序的视图层代码，执行在普通的 WKWebview 中</li><li>上图只开了一个小程序页面却显示了两个 page-frame.html，说明始终有一个页面在后台加载，准备打开小程序的其他页面（<a href="https://juejin.im/book/5b70f101e51d456669381803/section/5b70f3456fb9a00986735fa3" target="_blank" rel="noopener noreferrer">基础篇 3：小程序架构及其实现机制</a>中介绍过）</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="调试-jscontext">调试 JSContext<a aria-hidden="true" class="hash-link" href="#调试-jscontext" title="Direct link to heading">​</a></h4><p>打开 JSContext 之后，找到的第一个 JS 文件实际就是微信的逻辑层代码执行 <code>waservice.js</code> 了：</p><p><img src="https://user-gold-cdn.xitu.io/2018/8/15/1653c216bcac23f1?w=1000&amp;h=650&amp;f=png&amp;s=250489"></p><p>另外看到一些 <code>JSBridge.subscribeHandle</code> 的代码实际是 Native 实现的一些方法或事件，然后调用 JSContext 中的方法回传数据的。下面是点击事件的一个截图，会看到点击事件传递的数据。</p><p><img src="https://user-gold-cdn.xitu.io/2018/8/15/1653c21abc0044aa?w=1000&amp;h=650&amp;f=png&amp;s=222778"></p><h4 class="anchor anchorWithStickyNavbar_31ik" id="调试-page-framehtml">调试 page-frame.html<a aria-hidden="true" class="hash-link" href="#调试-page-framehtml" title="Direct link to heading">​</a></h4><p><code>page-frame</code> 的页面是普通的 WebView 容器，可以在 Safari 中直接 debug，下面笔者通过 Console 面板修改 <code>#canvas-wrapper</code> 节点的内容：</p><p><img src="https://user-gold-cdn.xitu.io/2018/8/15/1653c218687897a9?w=1000&amp;h=650&amp;f=png&amp;s=230180"></p><p>修改后，在手机上看到效果：</p><p><img src="https://user-gold-cdn.xitu.io/2018/8/17/16546a273f1004b9?w=400&amp;h=708&amp;f=png&amp;s=226556"></p><p>这说明实际 WebView 内是可以进行 DOM 操作的，而且也可以使用普通的 BOM 对象，如 <code>alert</code>、<code>location</code>等。</p><p><img src="https://user-gold-cdn.xitu.io/2018/8/17/16546a1f7b889207?w=750&amp;h=1334&amp;f=jpeg&amp;s=61647"></p><h4 class="anchor anchorWithStickyNavbar_31ik" id="使用-reveal-查看-ui-布局">使用 Reveal 查看 UI 布局<a aria-hidden="true" class="hash-link" href="#使用-reveal-查看-ui-布局" title="Direct link to heading">​</a></h4><p>如果要研究微信小程序的布局，可以使用 Reveal 软件来查看 UI 布局。如下图所示，在今日头条的小程序布局中，可以看到播放器组件是 Native 实现的组件，而我们做的新鲜天气小程序的雨雪效果 Canvas 也是 Native 实现的。</p><p><img src="https://user-gold-cdn.xitu.io/2018/8/15/1653c22207fc956c?w=1312&amp;h=833&amp;f=jpeg&amp;s=173509"></p><p><img src="https://user-gold-cdn.xitu.io/2018/8/17/16546a116a36f207?w=1527&amp;h=1050&amp;f=jpeg&amp;s=216044"></p><p>要开启 Reveal，需要经过下面的步骤：</p><ol><li>安装 Reveal，然后通过菜单「Help -&gt; Show Reveal Library in Finder -&gt; iOS Library」，打开 <code>RevealServer.framework</code> 所在目录</li><li>将 <code>RevealServer.framework</code> 复制到 IPAPatch 的 <code>Assets/Frameworks/</code> 内</li></ol><p>上面两个步骤如果都正确，再次用 Xcode 打开 IPAPatch 编译运行，打开小程序后，会在 Reveal 中看到可以操作了。</p><p><img src="https://user-gold-cdn.xitu.io/2018/8/15/1653c225cdc43fad?w=1312&amp;h=833&amp;f=jpeg&amp;s=76912"></p><p>这时候点击 icon 就可以随意查看 UI 布局了。</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="android-手机使用-x5-inspect-版本进行真机调试">Android 手机使用 X5 inspect 版本进行真机调试<a aria-hidden="true" class="hash-link" href="#android-手机使用-x5-inspect-版本进行真机调试" title="Direct link to heading">​</a></h3><p>安装 X5 inspect 版本之后，就可以使用 Chrome 的远程调控功能来调试小程序了。具体操作步骤如下：</p><ol><li>用 Android 版微信关注「腾讯浏览服务」公众号，点击菜单「TBS 公测」然后回答 5 个问题，就可以下载 X5 测试版本</li><li>打开 Android 手机的「开发者选项 -&gt; USB 调试」功能，连上电脑数据线，这时候如果有<code>adb</code>可以执行<code>adb devices</code>看下是否连接成功（<code>adb</code> 是 <code>android debug bridge</code> 安卓调试桥简称，<a href="https://developer.android.com/studio/command-line/adb" target="_blank" rel="noopener noreferrer">官方地址</a>）</li><li>微信扫码访问：<a href="http://debugx5.qq.com" target="_blank" rel="noopener noreferrer">http://debugx5.qq.com</a></li></ol><p><img src="https://user-gold-cdn.xitu.io/2018/8/13/165313e946af4355?w=280&amp;h=280&amp;f=png&amp;s=1417"></p><ol start="4"><li>切换到「信息」选项卡，勾选下图中的三项：「打开 TBS 内核 Inspector/X5jscore Inspector/小程序调试功能」</li></ol><p><img src="https://user-gold-cdn.xitu.io/2018/8/13/165313ebef91bfff?w=1080&amp;h=1920&amp;f=jpeg&amp;s=110911"></p><p>有关 Chrome 远程调控的更多资料可以访问 <a href="https://developers.google.com/web/tools/chrome-devtools/remote-debugging/" target="_blank" rel="noopener noreferrer">Chrome Web Developers 官网教程</a>。</p><p>PS：安卓下调试小程序有一定概率会失败，感觉不是很稳定。</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="上线">上线<a aria-hidden="true" class="hash-link" href="#上线" title="Direct link to heading">​</a></h2><p>小程序开发完成之后，使用 <code>npm run build</code> 打包，然后准备上线：</p><ol><li>上传云函数，保证云函数是最新代码</li><li>在开发者工具页面右上角选择「上传」，弹出提示框填写版本号和备注（备注可以不填写）</li></ol><p><img src="https://user-gold-cdn.xitu.io/2018/8/17/16546a78dc502122?w=597&amp;h=165&amp;f=jpeg&amp;s=16810"></p><ol start="3"><li>登录微信<a href="https://mp.weixin.qq.com/" target="_blank" rel="noopener noreferrer">小程序管理后台</a>，左侧菜单选择「开发管理」，可以看到刚刚上传的版本号代码</li></ol><p><img src="https://user-gold-cdn.xitu.io/2018/8/17/16546a4b78f8a028?w=757&amp;h=182&amp;f=jpeg&amp;s=16998"></p><p>点击「提交审核」按钮会出现提示框，直接「下一步」，进入「配置功能页面」，这个页面需要填写小程序的主要功能页面。配置合理的标题和类目，可以帮助小程序更好地被检索。</p><p>这里笔者填写的内容如下：</p><p><img src="https://user-gold-cdn.xitu.io/2018/8/15/1653c230ec2e6515?w=751&amp;h=879&amp;f=jpeg&amp;s=71545"></p><p>填写完「配置功能页面」之后，点击提交审核，就进入审核流程了。一般一次审核在几个小时到一天之间，第一次审核会相对慢一些，笔者提交了几次审核，最快的 3 个小时就审核通过了。审核通过后，绑定小程序开发者账号的微信号会收到提醒：</p><p><img src="https://user-gold-cdn.xitu.io/2018/8/18/1654a7f0617d94e6?w=750&amp;h=494&amp;f=jpeg&amp;s=44098"></p><p>收到提醒后，再次登录<a href="https://mp.weixin.qq.com/" target="_blank" rel="noopener noreferrer">小程序管理后台</a>，在「开发管理」处会标记是已经审核通过待发布的版本。</p><p><img src="https://user-gold-cdn.xitu.io/2018/8/17/1654736552b78625?w=963&amp;h=209&amp;f=jpeg&amp;s=22479"></p><p>点击发布可以选择「全量发布」和小流量发布，这时候根据自己情况选择即可。</p><blockquote><p><strong>Tips：</strong></p><ol><li>如果发现提交审核的代码有问题或者新开发了一个版本，可以在管理后台撤回审核的版本，再提交新版本审核即可</li><li>上传代码后，可以在小程序后台设置刚刚上传的代码为「体验版本」，设置后可以扫描版本号下面的体验版本二维码进行体验</li><li>如果发布的版本出现重大 bug，可以在「开发管理」页面对线上版本选择「版本回退」</li></ol></blockquote><h3 class="anchor anchorWithStickyNavbar_31ik" id="设置体验版本">设置体验版本<a aria-hidden="true" class="hash-link" href="#设置体验版本" title="Direct link to heading">​</a></h3><p>设置体验版本有点类似小范围公测，需要将代码通过开发者工具先上传，然后在小程序管理后台设置体验版本。体验版本并不是任何人都可以体验的，需要开发者主账号在「管理后台 -&gt; 用户身份」添加体验账号。</p><p><img src="https://user-gold-cdn.xitu.io/2018/8/15/1653c23541562e30?w=1308&amp;h=711&amp;f=jpeg&amp;s=69329"></p><p>设置用户身份之后，上传代码之后，在后台设置体验版本，体验版本设置成功之后，会有版本号二维码可以扫码体验。</p><p><img src="https://user-gold-cdn.xitu.io/2018/8/15/1653c237cc920995?w=590&amp;h=582&amp;f=jpeg&amp;s=45182"></p><h2 class="anchor anchorWithStickyNavbar_31ik" id="数据分析">数据分析<a aria-hidden="true" class="hash-link" href="#数据分析" title="Direct link to heading">​</a></h2><p>上线后的小程序，可以在<a href="https://mp.weixin.qq.com/" target="_blank" rel="noopener noreferrer">小程序管理后台</a>，看到一些基本统计数据：</p><p><img src="https://user-gold-cdn.xitu.io/2018/8/17/1654735022cd9d90?w=960&amp;h=487&amp;f=jpeg&amp;s=31887"></p><p>小程序 API 还提供<strong>自定义分析</strong>功能，可以通过<a href="https://developers.weixin.qq.com/miniprogram/analysis/custom/" target="_blank" rel="noopener noreferrer">自定义分析</a>页面定制自己的分析。</p><p>对于开发者而言，最关注的应该是程序异常数据，小程序的<a href="https://developers.weixin.qq.com/miniprogram/dev/api/monitor-report.html" target="_blank" rel="noopener noreferrer">监控报警 API</a> 提供数据监控上报的功能。使用前，需要在「<a href="https://mp.weixin.qq.com/" target="_blank" rel="noopener noreferrer">小程序管理后台</a> -&gt; 运维中心 -&gt; 性能监控 -&gt; 业务数据监控」中新建监控事件，配置监控描述与告警类型。</p><p><img src="https://user-gold-cdn.xitu.io/2018/8/15/1653c23d5779b844?w=959&amp;h=595&amp;f=jpeg&amp;s=37773"></p><p>创建完后，可以通过 API 进行数据上报：</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 参数是监控 id 和上报数值</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">reportMonitor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;1&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_31ik" id="小结">小结<a aria-hidden="true" class="hash-link" href="#小结" title="Direct link to heading">​</a></h2><p>本节介绍了小程序调试技巧和上线发布流程，以及小程序数据上报分析方法。在调试技巧中，重点介绍了如何在 iOS 和 安卓真机中调试微信中的小程序，希望上面的调试技巧可以帮助小程序开发者快速定位问题。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/dapengdouyu/docs/tree/master/docs/books/微信小程序开发入门：从 0 到 1 实现天气小程序/实战篇 8：小程序调试技巧和上线发布.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2021-10-11T06:28:32.000Z">10/11/2021</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/books/微信小程序开发入门：从 0 到 1 实现天气小程序/实战篇 7：对小程序进行优化"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« <!-- -->实战篇 7：对小程序进行优化</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/books/微信小程序开发入门：从 0 到 1 实现天气小程序/开篇：微信小程序概述"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">开篇：微信小程序概述<!-- --> »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#真机调试" class="table-of-contents__link toc-highlight">真机调试</a><ul><li><a href="#预览功能" class="table-of-contents__link toc-highlight">预览功能</a></li><li><a href="#远程调试" class="table-of-contents__link toc-highlight">远程调试</a></li><li><a href="#ios-调试" class="table-of-contents__link toc-highlight">iOS 调试</a></li><li><a href="#android-手机使用-x5-inspect-版本进行真机调试" class="table-of-contents__link toc-highlight">Android 手机使用 X5 inspect 版本进行真机调试</a></li></ul></li><li><a href="#上线" class="table-of-contents__link toc-highlight">上线</a><ul><li><a href="#设置体验版本" class="table-of-contents__link toc-highlight">设置体验版本</a></li></ul></li><li><a href="#数据分析" class="table-of-contents__link toc-highlight">数据分析</a></li><li><a href="#小结" class="table-of-contents__link toc-highlight">小结</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021 dapeng (张亚鹏) 京ICP备20028300号</div></div></div></footer></div>
<script src="/assets/js/runtime~main.0460df01.js"></script>
<script src="/assets/js/main.1f72a20d.js"></script>
</body>
</html>