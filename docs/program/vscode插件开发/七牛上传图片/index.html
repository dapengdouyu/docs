<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.13">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="Dapeng&#39;s blog RSS Feed">
<script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?7dda2565ba246ecd62878c13153e2941",e.defer=!0;var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
<meta name="baidu-site-verification" content="IXU12YQUjF">
<link rel="preconnect" href="https://hmcdn.baidu.com">
<link rel="stylesheet" href="https://cansiny.oss-cn-shanghai.aliyuncs.com/assets/fonts.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><title data-react-helmet="true">vscode æ’ä»¶ä»å…¥é—¨åˆ°å®æˆ˜ - Dapengçš„åšå®¢</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://dapengdouyu.github.io/docs/program/vscodeæ’ä»¶å¼€å‘/ä¸ƒç‰›ä¸Šä¼ å›¾ç‰‡"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="vscode æ’ä»¶ä»å…¥é—¨åˆ°å®æˆ˜ - Dapengçš„åšå®¢"><meta data-react-helmet="true" name="description" content="VSCode ç»„æˆç»“æ„"><meta data-react-helmet="true" property="og:description" content="VSCode ç»„æˆç»“æ„"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://dapengdouyu.github.io/docs/program/vscodeæ’ä»¶å¼€å‘/ä¸ƒç‰›ä¸Šä¼ å›¾ç‰‡"><link data-react-helmet="true" rel="alternate" href="https://dapengdouyu.github.io/docs/program/vscodeæ’ä»¶å¼€å‘/ä¸ƒç‰›ä¸Šä¼ å›¾ç‰‡" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://dapengdouyu.github.io/docs/program/vscodeæ’ä»¶å¼€å‘/ä¸ƒç‰›ä¸Šä¼ å›¾ç‰‡" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.978f73f5.css">
<link rel="preload" href="/assets/js/runtime~main.e2552c1f.js" as="script">
<link rel="preload" href="/assets/js/main.d3677d32.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.jpg" alt="DAPENG" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/img/logo.jpg" alt="DAPENG" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">DAPENG</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link" href="/">åšå®¢</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/tags/java-script">JavaScript</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link">å‰ç«¯</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/program/javascript">Javascript</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link">é˜…è¯»</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/books/Babel æ’ä»¶é€šå…³ç§˜ç±">Babel æ’ä»¶é€šå…³ç§˜ç±</a></li></ul></div><a href="https://github.com/dapengdouyu" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">ğŸŒœ</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">ğŸŒ</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/program/Buffer/">Buffer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/program/CRP/">CRP</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/program/HTMLå’ŒCSS/">HTMLå’ŒCSS</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/program/UUID/">UUID</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/program/binary/">binary</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/program/electron/">electron</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/program/es6/">es6</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/program/eventLoop/">eventLoop</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/program/javascript/">javascript</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/program/linux/">linux</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/program/math/">math</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/program/network/">network</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/program/node/">node</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/program/react/">react</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/program/rollup/">rollup</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/program/typescript/">typescript</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_2fq0" href="/docs/program/vscodeæ’ä»¶å¼€å‘/">vscodeæ’ä»¶å¼€å‘</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/program/vscodeæ’ä»¶å¼€å‘/">index</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/program/vscodeæ’ä»¶å¼€å‘/ä¸ƒç‰›ä¸Šä¼ å›¾ç‰‡">vscode æ’ä»¶ä»å…¥é—¨åˆ°å®æˆ˜</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/program/vue/">vue</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/program/webpack/">webpack</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/program/å…¶ä»–/">å…¶ä»–</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/program/æ‰“åŒ…å·¥å…·/">æ‰“åŒ…å·¥å…·</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/program/æ­£åˆ™/">æ­£åˆ™</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/program/ç®—æ³•/">ç®—æ³•</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/program/è·¨å¹³å°/">è·¨å¹³å°</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_2fq0" href="/docs/program/é¢è¯•/">é¢è¯•</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_1CGd"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_3E-R"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>vscode æ’ä»¶ä»å…¥é—¨åˆ°å®æˆ˜</h1></header><h2 class="anchor anchorWithStickyNavbar_31ik" id="vscode-ç»„æˆç»“æ„">VSCode ç»„æˆç»“æ„<a aria-hidden="true" class="hash-link" href="#vscode-ç»„æˆç»“æ„" title="Direct link to heading">â€‹</a></h2><p><code>VSCode</code> æ˜¯åŸºäº <a href="http://www.electronjs.org/" target="_blank" rel="noopener noreferrer">Electron</a> æ„å»ºçš„ï¼Œä¸»è¦ç”±ä¸‰éƒ¨åˆ†æ„æˆ:</p><ul><li>Electron: UI<ul><li>Monaco Editor</li><li>Extension Host</li></ul></li><li>Language Server Protocol &amp; Debug Adapter Protocol</li></ul><p><img src="http://img.zhangyapeng.club/vscode%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/%E4%B8%83%E7%89%9B%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87/v2-ee9ce222ceb0a0d84ad7be12e05a4a91_b.jpg" alt="vscodeæ’ä»¶å¼€å‘/ä¸ƒç‰›ä¸Šä¼ å›¾ç‰‡"></p><p>VSCode ä¸­çš„å¤§éƒ¨åˆ†åŠŸèƒ½éƒ½æ˜¯é€šè¿‡ <code>Extension Host</code> æ¥å®ç°çš„ã€‚ç¬¦åˆ LSP çš„æ’ä»¶å¯¹åº”çš„é«˜äº®ç­‰è¯­è¨€ç‰¹æ€§å°±ä¼šåæ˜ åˆ° Monaco Editor ä¸Šã€‚ä»æºç çš„ <a href="https://link.zhihu.com/?target=https%3A//github.com/microsoft/vscode/tree/master/extensions" target="_blank" rel="noopener noreferrer">extensions</a> ç›®å½•ä¸­å¯ä»¥çœ‹åˆ°ï¼ŒVSCode é»˜è®¤é›†æˆäº†å„ç§è¯­è¨€çš„æ’ä»¶ã€‚</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="monaco-editor">Monaco Editor<a aria-hidden="true" class="hash-link" href="#monaco-editor" title="Direct link to heading">â€‹</a></h3><p>æ˜¯ä¸€ä¸ªåŸºäºç½‘é¡µçš„ç¼–è¾‘å™¨ï¼Œæœ‰ç¬¦åˆ <code>LSP çš„æ’ä»¶</code>å°±å¯ä»¥è¿›è¡Œ<code>é«˜äº®</code>ã€<code>æ‚¬åœæç¤º</code>ï¼Œ<code>å¯¼èˆªåˆ°å®šä¹‰</code>ã€<code>è‡ªåŠ¨è¡¥å…¨</code>ã€<code>æ ¼å¼åŒ–</code>ç­‰åŠŸèƒ½ã€‚å®ƒçš„ä»£ç ä½äº <a href="https://link.zhihu.com/?target=https%3A//github.com/Microsoft/monaco-editor" target="_blank" rel="noopener noreferrer">monaco-editor</a></p><h3 class="anchor anchorWithStickyNavbar_31ik" id="extension-host">Extension Host<a aria-hidden="true" class="hash-link" href="#extension-host" title="Direct link to heading">â€‹</a></h3><p>VSCode çš„<code>ä¸»è¿›ç¨‹</code>å’Œ<code>æ’ä»¶è¿›ç¨‹</code>æ˜¯åˆ†å¼€ç®¡ç†çš„ï¼Œ<code>Extension Host</code> å°±æ˜¯ç”¨æ¥ç®¡ç†æ’ä»¶è¿›ç¨‹çš„ã€‚</p><p><code>Extension Host</code> æ˜¯ç”¨æ¥ç¡®ä¿æ’ä»¶ï¼š</p><ul><li>ä¸å½±å“<code>å¯åŠ¨é€Ÿåº¦</code></li><li>ä¸ä¼šå‡ä½ UI <code>å“åº”é€Ÿåº¦</code></li><li>ä¸ä¼šæ”¹å˜ <code>UI æ ·å¼</code></li></ul><p>å› æ­¤ä¿è¯ VSCode çš„<code>ç¨³å®š</code>å’Œ<code>å¿«é€Ÿ</code>çš„ç§˜å¯†:</p><ul><li>å°±åœ¨äºä½¿ç”¨ <code>Extension Host</code> å°†<code>ä¸»è¿›ç¨‹</code>å’Œ<code>æ’ä»¶è¿›ç¨‹</code>åˆ†å¼€ï¼Œä½¿æ’ä»¶ä¸ä¼šå½±å“åˆ° VSCode ä¸»è¿›ç¨‹çš„æ€§èƒ½å’Œç¨³å®šã€‚</li><li>åœ¨ç¼–å†™æ’ä»¶çš„æ—¶å€™ <code>VSCode</code> å¯ä»¥è®©æ’ä»¶è®¾ç½® <code>Activation Events</code> æ¥å¯¹æ’ä»¶æ‡’åŠ è½½ã€‚<ul><li>æ¯”å¦‚åªæœ‰æ‰“å¼€äº† Markdown æ–‡ä»¶æ‰æ‰“å¼€å¯¹åº”çš„æ’ä»¶ã€‚è¿™æ ·å¯ä»¥é™ä½æ— è°“çš„ CPU å’Œå†…å­˜ä½¿ç”¨ã€‚</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="language-server-protocol--debug-adapter-protocol">Language Server Protocol &amp; Debug Adapter Protocol<a aria-hidden="true" class="hash-link" href="#language-server-protocol--debug-adapter-protocol" title="Direct link to heading">â€‹</a></h3><p>è¿™ä¸¤ä¸ªåè®®ä¸»è¦æ˜¯ä¸ºäº†å°†<code>ç¼–è¾‘å™¨</code>å’Œ<code>ç¼–ç¨‹è¯­è¨€</code>/<code>è°ƒè¯•æœåŠ¡</code>çš„åŠŸèƒ½åˆ†ç¦»å¼€,å®ç°ä»»ä½•è¯­è¨€åªè¦ç¼–å†™å¯¹åº”çš„è¯­è¨€æœåŠ¡å³å¯ã€‚ç›®å‰å„å¤§ç¼–è¾‘å™¨éƒ½å·²ç»æ”¯æŒäº†è¿™ä¸ªåè®®ã€‚</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="vscode-æä¾›äº†å“ªäº›å¼€æ”¾èƒ½åŠ›">vscode æä¾›äº†å“ªäº›å¼€æ”¾èƒ½åŠ›ï¼Ÿ<a aria-hidden="true" class="hash-link" href="#vscode-æä¾›äº†å“ªäº›å¼€æ”¾èƒ½åŠ›" title="Direct link to heading">â€‹</a></h2><p>vscode ä¸»è¦æä¾›äº†å…­ç±»å¼€æ”¾èƒ½åŠ›ï¼š<code>é€šç”¨èƒ½åŠ›</code>ã€<code>ä¸»é¢˜</code>ã€<code>å£°æ˜ç±»è¯­è¨€ç‰¹æ€§</code>ï¼ˆæˆ‘æŠŠå®ƒç§°ä¸ºåŸºç¡€æ”¯æŒï¼‰ã€<code>ç¨‹åºç±»è¯­è¨€ç‰¹æ€§</code>ï¼ˆé«˜çº§æ”¯æŒï¼‰ã€<code>å·¥ä½œåŒº UI æ‰©å±•</code>ã€<code>è°ƒè¯•</code>ã€‚
<img src="http://img.zhangyapeng.club/vscode%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/%E4%B8%83%E7%89%9B%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87/v2-192030e56282c8a3e2dfaa3483403eb4_b.jpg" alt="vscodeæ’ä»¶å¼€å‘/ä¸ƒç‰›ä¸Šä¼ å›¾ç‰‡"></p><h2 class="anchor anchorWithStickyNavbar_31ik" id="å¦‚ä½•ç¼–å†™ä¸€ä¸ª-vscode-æ’ä»¶å‘¢">å¦‚ä½•ç¼–å†™ä¸€ä¸ª vscode æ’ä»¶å‘¢ï¼Ÿ<a aria-hidden="true" class="hash-link" href="#å¦‚ä½•ç¼–å†™ä¸€ä¸ª-vscode-æ’ä»¶å‘¢" title="Direct link to heading">â€‹</a></h2><p><code>vscode</code> æ’ä»¶çš„å½¢æ€å’Œä¸€ä¸ª <code>npm</code>åŒ…éå¸¸ç›¸ä¼¼ï¼Œéœ€è¦åœ¨é¡¹ç›®çš„æ ¹ç›®å½•æ·»åŠ <code>package.json</code>ï¼Œå¹¶ä¸”åœ¨å…¶ä¸­å¢åŠ ä¸€äº› <code>vscode ç‹¬å®¶</code>çš„è®¾ç½®ã€‚å…¶ä¸­æœ€ä¸»è¦çš„è®¾ç½®æ˜¯ <code>Activation Events</code>(æ’ä»¶çš„æ¿€æ´»æ—¶æœº) å’Œ <code>contribution points</code> (æ’ä»¶çš„èƒ½åŠ›)ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ä¸»è¦çœ‹çœ‹è¿™ä¸¤ä¸ªé…ç½®å…·ä½“æ˜¯ä»€ä¹ˆæ„æ€ã€‚</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="activation-eventsæ’ä»¶çš„æ¿€æ´»æ—¶æœº"><a href="https://link.zhihu.com/?target=https%3A//code.visualstudio.com/api/references/activation-events" target="_blank" rel="noopener noreferrer">Activation Events</a>(æ’ä»¶çš„æ¿€æ´»æ—¶æœº)<a aria-hidden="true" class="hash-link" href="#activation-eventsæ’ä»¶çš„æ¿€æ´»æ—¶æœº" title="Direct link to heading">â€‹</a></h3><p>vscode çš„<code>å£°æ˜å‘¨æœŸ</code>å¦‚ä¸‹å›¾ï¼š</p><p><img src="http://img.zhangyapeng.club/vscode%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/%E4%B8%83%E7%89%9B%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87/v2-34537230f980d7849db68113668f6db0_b.jpg" alt="vscodeæ’ä»¶å¼€å‘/ä¸ƒç‰›ä¸Šä¼ å›¾ç‰‡"></p><h4 class="anchor anchorWithStickyNavbar_31ik" id="activate-å‡½æ•°--deactivate-å‡½æ•°"><code>activate</code>() å‡½æ•° &amp; <code>deactivate</code>() å‡½æ•°<a aria-hidden="true" class="hash-link" href="#activate-å‡½æ•°--deactivate-å‡½æ•°" title="Direct link to heading">â€‹</a></h4><p>å¯ä»¥çœ‹åˆ°ç”Ÿå‘½å‘¨æœŸä¸­æœ€ç»ˆè¦çš„ä¸¤ä¸ªèŠ‚ç‚¹å°±æ˜¯ <code>activate</code> å‡½æ•°å’Œ <code>deactivate</code> å‡½æ•°ã€‚è¿™ä¸¤ä¸ªå‡½æ•°éœ€è¦åœ¨æ’ä»¶ <code>npm</code> æ¨¡å—çš„å…¥å£æ–‡ä»¶ <code>export</code> å‡ºå»ç»™ <code>vscode</code> ä¸»åŠ¨è°ƒç”¨ã€‚å…¶ä¸­ï¼Œ<code>activate</code> ä¼šåœ¨ <code>vscode</code> è®¤ä¸º<code>åˆé€‚çš„æ—¶æœº</code>è°ƒç”¨ï¼Œå¹¶ä¸”åœ¨æ’ä»¶çš„è¿è¡Œå‘¨æœŸå†…<code>åªè°ƒç”¨ä¸€æ¬¡</code>ã€‚å› æ­¤åœ¨ <code>activate</code> å‡½æ•°ä¸­å¼€å§‹<code>å¯åŠ¨æ’ä»¶</code>çš„é€»è¾‘ï¼Œæ˜¯ä¸€ä¸ªéå¸¸åˆé€‚çš„æ—¶æœºã€‚<code>deactivate</code> å‡½æ•°ä¼šåœ¨æ’ä»¶<code>å¸è½½ä¹‹å‰</code>è°ƒç”¨ï¼Œå¦‚æœä½ çš„å¸è½½é€»è¾‘ä¸­å­˜åœ¨<code>å¼‚æ­¥æ“ä½œ</code>ï¼Œé‚£ä¹ˆåªéœ€è¦åœ¨ <code>deactivate</code> å‡½æ•°ä¸­ <code>retuen</code> ä¸€ä¸ª <code>promise</code> å¯¹è±¡ï¼Œvscode ä¼šåœ¨ <code>promise resolve</code> æ—¶æ‰æ­£å¼å°†æ’ä»¶å¸è½½æ‰ã€‚</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="onxxxx-activation-events">onXxxx Activation Events<a aria-hidden="true" class="hash-link" href="#onxxxx-activation-events" title="Direct link to heading">â€‹</a></h4><p>å¯ä»¥çœ‹åˆ°åœ¨ <code>activate</code> å‡½æ•°ä¹‹å‰ï¼Œè¿˜æœ‰<code>onLanguage</code> ç­‰äº‹ä»¶çš„æè¿°ï¼Œå®é™…ä¸Šè¿™äº›å°±æ˜¯<code>å£°æ˜</code>åœ¨æ’ä»¶ package.json æ–‡ä»¶ä¸­çš„ <code>Activation Events</code>ã€‚å£°æ˜è¿™äº› <code>Activation Events</code> åï¼Œvscode å°±ä¼šåœ¨<code>é€‚å½“çš„æ—¶æœº</code>å›è°ƒæ’ä»¶ä¸­çš„ <code>activate</code> å‡½æ•°ã€‚<code>vscode</code> ä¹‹æ‰€ä»¥è¿™ä¹ˆè®¾è®¡ï¼Œæ˜¯ä¸ºäº†èŠ‚çœèµ„æºå¼€é”€ï¼Œåªåœ¨<code>å¿…è¦</code>çš„æ—¶å€™æ‰æ¿€æ´»ä½ çš„æ’ä»¶ã€‚å½“ç„¶ï¼Œå¦‚æœä½ çš„æ’ä»¶éå¸¸é‡è¦ï¼Œä¸å¸Œæœ›åœ¨æŸä¸ªäº‹ä»¶ä¹‹åæ‰è¢«æ¿€æ´»ï¼Œä½ å¯ä»¥å£°æ˜ <code>Activation Events</code>ä¸º<code>\*</code>è¿™æ · <code>vscode</code> å°±ä¼šåœ¨<code>å¯åŠ¨</code>çš„æ—¶å€™å°±å¼€å§‹å›è°ƒ <code>activate</code>å‡½æ•°</p><ul><li><p>onLanguageï¼š åœ¨æ‰“å¼€å¯¹åº”è¯­è¨€æ–‡ä»¶æ—¶</p></li><li><p>onCommandï¼š åœ¨æ‰§è¡Œå¯¹åº”å‘½ä»¤æ—¶</p></li><li><p>onDebugï¼š åœ¨ debug ä¼šè¯å¼€å§‹å‰</p></li><li><p>onDebugInitialConfigurationsï¼š åœ¨åˆå§‹åŒ– debug è®¾ç½®å‰</p></li><li><p>onDebugResolveï¼š åœ¨ debug è®¾ç½®å¤„ç†å®Œä¹‹å‰</p></li><li><p>workspaceContainsï¼š åœ¨æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶å¤¹åï¼Œå¦‚æœæ–‡ä»¶å¤¹å†…åŒ…å«è®¾ç½®çš„<strong>æ–‡ä»¶åæ¨¡å¼</strong>æ—¶</p></li><li><p>onFileSystemï¼š æ‰“å¼€çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ï¼Œæ˜¯æ¥è‡ªäºè®¾ç½®çš„ç±»å‹æˆ–åè®®æ—¶</p></li><li><p>onViewï¼š ä¾§è¾¹æ ä¸­è®¾ç½®çš„ id é¡¹ç›®å±•å¼€æ—¶</p></li><li><p>onUriï¼š åœ¨åŸºäº vscode æˆ– vscode-insiders åè®®çš„ url æ‰“å¼€æ—¶</p></li><li><p>onWebviewPanelï¼š åœ¨æ‰“å¼€è®¾ç½®çš„ webview æ—¶</p></li><li><p>*<!-- -->ï¼š åœ¨æ‰“å¼€ vscode çš„æ—¶å€™ï¼Œå¦‚æœä¸æ˜¯å¿…é¡»ä¸€èˆ¬ä¸å»ºè®®è¿™ä¹ˆè®¾ç½®</p></li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="æ’ä»¶çš„å…·ä½“é€»è¾‘">æ’ä»¶çš„å…·ä½“é€»è¾‘<a aria-hidden="true" class="hash-link" href="#æ’ä»¶çš„å…·ä½“é€»è¾‘" title="Direct link to heading">â€‹</a></h4><p>æ’ä»¶ä¸­çš„å…·ä½“é€»è¾‘ <code>vscode</code> æ²¡æœ‰åšä»»ä½•é™åˆ¶ï¼Œä½ å¯ä»¥é€šè¿‡è°ƒç”¨<code>vscode</code>æä¾›çš„å„ç§<a href="https://code.visualstudio.com/api/references/vscode-api" target="_blank" rel="noopener noreferrer">api</a> å¯¹å…¶è¿›è¡Œæ‰©å……ã€‚ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå‡ºäºæ€§èƒ½å’Œç§»æ¤æ€§è€ƒè™‘ï¼Œ<code>vscode</code> ä¸å…è®¸å¼€å‘è€…<code>ç›´æ¥æ“ä½œ dom</code>ã€‚</p><p>ä¸»è¦æ˜¯ä»¥ä¸‹å„ç±»<code>API</code>ï¼š</p><ul><li><a href="https://link.zhihu.com/?target=https%3A//code.visualstudio.com/api/references/vscode-api%23commands" target="_blank" rel="noopener noreferrer">commands</a></li><li><a href="https://link.zhihu.com/?target=https%3A//code.visualstudio.com/api/references/vscode-api%23comments" target="_blank" rel="noopener noreferrer">comments</a></li><li><a href="https://link.zhihu.com/?target=https%3A//code.visualstudio.com/api/references/vscode-api%23debug" target="_blank" rel="noopener noreferrer">debug</a></li><li><a href="https://link.zhihu.com/?target=https%3A//code.visualstudio.com/api/references/vscode-api%23env" target="_blank" rel="noopener noreferrer">env</a></li><li><a href="https://link.zhihu.com/?target=https%3A//code.visualstudio.com/api/references/vscode-api%23extensions" target="_blank" rel="noopener noreferrer">extensions</a></li><li><a href="https://link.zhihu.com/?target=https%3A//code.visualstudio.com/api/references/vscode-api%23languages" target="_blank" rel="noopener noreferrer">languages</a></li><li><a href="https://link.zhihu.com/?target=https%3A//code.visualstudio.com/api/references/vscode-api%23scm" target="_blank" rel="noopener noreferrer">scm</a></li><li><a href="https://link.zhihu.com/?target=https%3A//code.visualstudio.com/api/references/vscode-api%23tasks" target="_blank" rel="noopener noreferrer">tasks</a></li><li><a href="https://link.zhihu.com/?target=https%3A//code.visualstudio.com/api/references/vscode-api%23window" target="_blank" rel="noopener noreferrer">window</a></li><li><a href="https://link.zhihu.com/?target=https%3A//code.visualstudio.com/api/references/vscode-api%23workspace" target="_blank" rel="noopener noreferrer">workspace</a></li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="ç¤ºä¾‹">ç¤ºä¾‹<a aria-hidden="true" class="hash-link" href="#ç¤ºä¾‹" title="Direct link to heading">â€‹</a></h4><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹å‡ ä¸ªæ’ä»¶çš„<code>Activation Events</code> å£°æ˜</p><ul><li><code>è¶…è¶Šé¼“åŠ±å¸ˆ</code> å£°æ˜äº† <code>onCommand:ycy.showReminderView</code> å’Œ <code>*</code>ï¼Œå…¶å®æˆ‘ä»¬éƒ½çŸ¥é“åªå£°æ˜åä¸€ä¸ªå°±è¶³å¤Ÿäº†</li><li><code>vuter</code> ç”³æ˜äº† <code>onLanguage:vue</code> æ‰€ä»¥ä»–ä¼šåœ¨ç”¨æˆ·æ‰“å¼€ vue è¯­è¨€æ–‡ä»¶æ—¶è¢«æ¿€æ´»</li><li><code>vscode-icons</code> æ˜¯ä¸€ä¸ªçº¯<code>ä¸»é¢˜</code>æ’ä»¶ï¼Œå£°æ˜çš„æ˜¯ <code>\*</code></li><li><code>GitLens</code> éœ€è¦è¦†ç›–<code>æ‰€æœ‰</code>çš„æ–‡ä»¶ï¼Œå¹¶ä¸”åœ¨ vscode å¯åŠ¨æ—¶å°±éœ€è¦æ¿€æ´»ï¼Œä»–çš„å£°æ˜æ˜¯<code>\*</code></li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="contribution-pointsæ’ä»¶çš„è´¡çŒ®ç‚¹"><a href="https://link.zhihu.com/?target=https%3A//code.visualstudio.com/api/references/contribution-points" target="_blank" rel="noopener noreferrer">contribution points</a>(æ’ä»¶çš„è´¡çŒ®ç‚¹)<a aria-hidden="true" class="hash-link" href="#contribution-pointsæ’ä»¶çš„è´¡çŒ®ç‚¹" title="Direct link to heading">â€‹</a></h3><p>éœ€è¦åœ¨ <code>package.json</code> ä¸­å£°æ˜çš„å¦ä¸€ä¸ªé‡è¦å­—æ®µå°±æ˜¯ <code>contribution points</code>ã€‚ <code>contribution points</code> æè¿°äº†å½“å‰æ’ä»¶<code>æ”¯æŒå“ªäº›èƒ½åŠ›</code>ï¼Œä»¥åŠå¯¹åº”èƒ½åŠ›çš„é…ç½®ã€‚
ç”±äº <code>vscode</code>ç¦æ­¢<code>ç›´æ¥æ“ä½œ dom</code>ï¼Œå¾€ <code>UI</code> ä¸­<code>æ’å…¥åŠŸèƒ½</code>çš„æ­£ç¡®æ–¹å¼æ˜¯<code>å£°æ˜è´¡çŒ®ç‚¹</code>ã€‚æè¿°ä½ æ‰€å†™çš„æ’ä»¶åœ¨å“ªäº›åœ°æ–¹æ·»åŠ äº†åŠŸèƒ½ï¼Œæ˜¯ä»€ä¹ˆæ ·çš„åŠŸèƒ½ï¼Œæ·»åŠ çš„å†…å®¹ä¼šæ˜¾ç¤ºåˆ°ç•Œé¢ä¸Š</p><p>ä¸‹å›¾åˆ—å‡ºäº†<code>vscode</code> æ”¯æŒçš„æ‰€æœ‰è´¡çŒ®ç‚¹ã€‚
<img src="http://img.zhangyapeng.club/vscode%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/%E4%B8%83%E7%89%9B%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87/v2-9aaf89306abaf2ef67b954e4489f10f4_b.jpg" alt="vscodeæ’ä»¶å¼€å‘/ä¸ƒç‰›ä¸Šä¼ å›¾ç‰‡"></p><h4 class="anchor anchorWithStickyNavbar_31ik" id="ç¤ºä¾‹-1">ç¤ºä¾‹<a aria-hidden="true" class="hash-link" href="#ç¤ºä¾‹-1" title="Direct link to heading">â€‹</a></h4><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹å‡ ä¸ªæ’ä»¶çš„ <code>contribution points</code> å£°æ˜</p><ul><li><code>è¶…è¶Šé¼“åŠ±å¸ˆ</code> æ”¯æŒé€šè¿‡ <code>commands</code> è§¦å‘æ¨è¶…è¶Šçš„æé†’ï¼ŒåŒæ—¶å¯ä»¥é…ç½®æé†’å‡ºç°çš„æ—¶æœºï¼Œå› æ­¤åŒ…æ‹¬ commands / configuration</li><li><code>vuter</code> ä¸»è¦ä¸º vue æ–‡ä»¶æä¾›è¯­è¨€æ”¯æŒï¼Œå¯ä»¥çœ‹åˆ°ä»–æä¾›çš„ <code>contribution points</code> æ¯”è¾ƒå¹¿ï¼ŒåŒ…æ‹¬ commands / breakpoints / languages / grammars / configuration</li><li><code>vscode-icons</code> å·²æ”¯æŒä¸»é¢˜ä¸ºä¸»ï¼Œä»–æä¾›äº† iconThemes / commands / configuration</li><li><code>GitLens</code> æ˜¯å¯¹ vscode git åŠŸèƒ½çš„å¢å¼ºï¼Œæ‰€ä»¥ä»–çš„æ’å…¥ç‚¹é›†ä¸­åœ¨ UI ä¸Šçš„èƒ½åŠ› configuration / commands / menus /resourceLabelFormatters / viewsContainers / views</li></ul><h2 class="anchor anchorWithStickyNavbar_31ik" id="api">Api<a aria-hidden="true" class="hash-link" href="#api" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_31ik" id="å…¥å£æ–‡ä»¶">å…¥å£æ–‡ä»¶<a aria-hidden="true" class="hash-link" href="#å…¥å£æ–‡ä»¶" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_K1bP language-ts"><div class="codeBlockContent_hGly ts"><pre tabindex="0" class="prism-code language-ts codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports operator" style="color:#393A34">*</span><span class="token imports"> </span><span class="token imports keyword" style="color:#00009f">as</span><span class="token imports"> vscode</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;vscode&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// æ’ä»¶æ¿€æ´»æ—¶çš„å…¥å£</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">activate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> vscode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">ExtensionContext</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// æ³¨å†Œ extension.helloWorld å‘½ä»¤</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> disposable </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vscode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">commands</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">registerCommand</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;extension.helloWorld&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      vscode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">showInformationMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Hello World!&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ç»™æ’ä»¶è®¢é˜… helloWorld å‘½ä»¤</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">subscriptions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">disposable</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// æ–°å¢çš„ä»£ç </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> helloVscode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vscode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">commands</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">registerCommand</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;extension.helloVscode&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      vscode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">showInformationMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Hello Vscode&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">subscriptions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">helloVscode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// return çš„å†…å®¹å¯ä»¥ä½œä¸ºè¿™ä¸ªæ’ä»¶å¯¹å¤–çš„æ¥å£</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">hello</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;hello world&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// æ’ä»¶é‡Šæ”¾çš„æ—¶å€™è§¦å‘</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">deactivate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li><code>ExtensionContext</code></li></ul><p>å­—é¢ä¸Šæ„æ€æ˜¯ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå®é™…ä¸Šå°±æ˜¯å½“å‰æ’ä»¶çš„çŠ¶æ€ä¿¡æ¯ã€‚
<img src="http://img.zhangyapeng.club/vscode%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/%E4%B8%83%E7%89%9B%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87/context.png" alt="vscodeæ’ä»¶å¼€å‘/ä¸ƒç‰›ä¸Šä¼ å›¾ç‰‡"></p><ul><li><code>registerCommand å’Œ subscriptions.push()</code></li></ul><p>å®Œæ•´çš„ API æ˜¯ï¼š<code>registerCommand(command: string, callback: (args: any[]) =&gt; any, thisArg?: any): Disposable</code></p><p>è¿™ä¸ªçš„ä¸»è¦åŠŸèƒ½æ˜¯ç»™åŠŸèƒ½ä»£ç (<code>callback</code>)æ³¨å†Œä¸€ä¸ªå‘½ä»¤(<code>command</code>)ï¼Œç„¶åé€šè¿‡ <code>subscriptions.push()</code> ç»™æ’ä»¶è®¢é˜…å¯¹åº”çš„ <code>command</code> äº‹ä»¶ã€‚</p><ul><li><code>return</code> ç»™å…¶ä»–æ’ä»¶æä¾›æ¥å£</li></ul><p>å¦‚æœéœ€è¦ä½¿ç”¨å…¶ä»–æ’ä»¶æä¾›çš„æ¥å£ï¼Œåˆ™å¯ä»¥åœ¨ <code>package.json</code> ä¸­å°†å¯¹åº”æ’ä»¶æ·»åŠ åˆ° <code>extensionDependency</code> ä¸­ï¼Œç„¶åä½¿ç”¨ <code>getExtension</code> å‡½æ•°ä¸­çš„ <code>export</code> å±æ€§ã€‚</p><div class="codeBlockContainer_K1bP language-ts"><div class="codeBlockContent_hGly ts"><pre tabindex="0" class="prism-code language-ts codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">activate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> vscode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">ExtensionContext</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> api </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">hello</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;hello world&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> api</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// å¼•å…¥å…¶ä»–æ’ä»¶æ¥å£</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> helloWorld </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> extensions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getExtension</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;helloWorld&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> importedApi </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> helloWorld</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exports</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">importedApi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">hello</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="unit-test"><a href="https://code.visualstudio.com/api/working-with-extensions/testing-extension" target="_blank" rel="noopener noreferrer">Unit Test</a><a aria-hidden="true" class="hash-link" href="#unit-test" title="Direct link to heading">â€‹</a></h3><p>æµ‹è¯•æ’ä»¶å¯ä»¥ä½¿ç”¨ <code>vscode-test</code> API æ¥åšæµ‹è¯•ã€‚éœ€è¦ç»™å®ƒçš„ <code>runTests</code> æä¾› <code>extensionDevelopmentPath, extensionTestsPath</code> å³å¼€å‘ç›®å½•å’Œæµ‹è¯•æ–‡ä»¶ç›®å½•ã€‚æµ‹è¯•åˆ™ä½¿ç”¨ä¹ æƒ¯çš„å•å…ƒæµ‹è¯•æ¡†æ¶å³å¯ã€‚</p><div class="codeBlockContainer_K1bP language-ts"><div class="codeBlockContent_hGly ts"><pre tabindex="0" class="prism-code language-ts codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports operator" style="color:#393A34">*</span><span class="token imports"> </span><span class="token imports keyword" style="color:#00009f">as</span><span class="token imports"> path</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;path&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> runTests </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;vscode-test&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// The folder containing the Extension Manifest package.json</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Passed to `--extensionDevelopmentPath`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> extensionDevelopmentPath </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">resolve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">__dirname</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;../../&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// The path to the extension test script</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Passed to --extensionTestsPath</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> extensionTestsPath </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">resolve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">__dirname</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;./suite/index&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Download VS Code, unzip it and run the integration test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">runTests</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> extensionDevelopmentPath</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> extensionTestsPath </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Failed to run tests&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="api-è®¾è®¡çš„æ¨¡å¼">API è®¾è®¡çš„æ¨¡å¼<a aria-hidden="true" class="hash-link" href="#api-è®¾è®¡çš„æ¨¡å¼" title="Direct link to heading">â€‹</a></h3><h4 class="anchor anchorWithStickyNavbar_31ik" id="promise">Promise<a aria-hidden="true" class="hash-link" href="#promise" title="Direct link to heading">â€‹</a></h4><p>VSCode API ä¸­å¼‚æ­¥æ“ä½œä½¿ç”¨çš„æ˜¯ Promiseï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ Then æˆ–è€… awaitã€‚å¤§éƒ¨åˆ†æƒ…å†µä¸‹ Thenable æ˜¯å¯é€‰çš„ï¼Œå¦‚æœ promise æ˜¯å¯é€‰çš„ï¼Œåˆ™ä¼šæœ‰ä¸€ä¸ªå¯é€‰ç±»å‹ã€‚</p><div class="codeBlockContainer_K1bP language-ts"><div class="codeBlockContent_hGly ts"><pre tabindex="0" class="prism-code language-ts codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">provideNumber</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token maybe-class-name">Thenable</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token builtin">number</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="cancellation-tokens">Cancellation Tokens<a aria-hidden="true" class="hash-link" href="#cancellation-tokens" title="Direct link to heading">â€‹</a></h3><p>åœ¨ä¸€ä¸ªæ“ä½œå®Œæˆå‰ï¼Œä¼šå¼€å§‹äºä¸€ä¸ªä¸ç¨³å®šçš„çŠ¶æ€ã€‚æ¯”å¦‚åœ¨å¼€å§‹ä»£ç æ™ºèƒ½æç¤ºæ—¶ï¼Œæœ€å¼€å§‹çš„æ“ä½œä¼šå› ä¸ºåé¢æŒç»­è¾“å…¥çš„å†…å®¹è¿‡æ—¶ã€‚</p><p>å¾ˆå¤š API ä¼šæœ‰ä¸€ä¸ª <code>CancellationToken</code>ï¼Œæ¥æ£€æŸ¥æ“ä½œæ˜¯å¦å–æ¶ˆ (<code>isCancellationRequested</code>)ï¼Œæˆ–è€…åœ¨å‘ç”Ÿå–æ¶ˆæ“ä½œæ—¶å¾—åˆ°é€šçŸ¥ (<code>onCancellationRequested</code>)ã€‚è¿™ä¸ª Token ä¸€èˆ¬æ˜¯å‡½æ•°çš„æœ€åä¸€ä¸ªå¯é€‰(å›è°ƒ)å‚æ•°ã€‚</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="disposables">Disposables<a aria-hidden="true" class="hash-link" href="#disposables" title="Direct link to heading">â€‹</a></h3><p>VSCode API å¯¹ä½¿ç”¨çš„å„ç±»èµ„æºåˆ©ç”¨ <code>dispose pattern</code> æ¥è¿›è¡Œé‡Šæ”¾ã€‚åº”ç”¨äºäº‹ä»¶ç›‘å¬ã€å‘½ä»¤ã€UI äº¤äº’ç­‰ã€‚</p><p>ä¾‹å¦‚ï¼šå¯¹äº <code>setStatusBarMessage(value: string)</code>ï¼ˆç»™çŠ¶æ€æ æ˜¾ç¤ºæ¶ˆæ¯ï¼‰å‡½æ•°è¿”å›ä¸€ä¸ª <code>Disposable</code> ç±»å‹ï¼Œç„¶åå¯ä»¥é€šè¿‡è°ƒç”¨å®ƒçš„ <code>dispose</code> æ¥ç§»é™¤ä¿¡æ¯ã€‚</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="events">Events<a aria-hidden="true" class="hash-link" href="#events" title="Direct link to heading">â€‹</a></h3><p>äº‹ä»¶åœ¨ VSCode API é‡Œé¢æ˜¯é€šè¿‡è®¢é˜…ç›‘å¬å‡½æ•°æ¥å®ç°çš„ã€‚è®¢é˜…åä¼šè¿”å›ä¸€ä¸ªæ”¯æŒ <code>Disposable</code> æ¥å£çš„å˜é‡ã€‚è°ƒç”¨ <code>dispose</code> å°±å¯ä»¥å–æ¶ˆç›‘å¬ã€‚</p><div class="codeBlockContainer_K1bP language-ts"><div class="codeBlockContent_hGly ts"><pre tabindex="0" class="prism-code language-ts codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">listener</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;It happened&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// å¼€å§‹ç›‘å¬</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> subscription </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> fsWatcher</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">onDidDelete</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">listener</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// æäº‹æƒ…</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subscription</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">dispose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// åœæ­¢ç›‘å¬</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>å¯¹äºäº‹ä»¶çš„å‘½åéµå¾ª <code>on[Will|Did]VerbNoun?</code> æ¨¡å¼ã€‚</p><ul><li>onWillï¼šå³å°†å‘ç”Ÿ</li><li>onDidï¼šå·²ç»å‘ç”Ÿ</li><li>verbï¼šå‘ç”Ÿäº†ä»€ä¹ˆ</li><li>nounï¼šäº‹ä»¶æ‰€å¤„ç¯å¢ƒï¼Œå¦‚æœå‘ç”Ÿåœ¨æ‰€å¤„çš„ç¯å¢ƒåˆ™å¯ä»¥ä¸åŠ ã€‚</li></ul><p>ä¾‹å¦‚ï¼š<code>window.onDidChangeActiveTextEditor</code></p><h3 class="anchor anchorWithStickyNavbar_31ik" id="web-view-ç”Ÿå‘½å‘¨æœŸ">web view ç”Ÿå‘½å‘¨æœŸ<a aria-hidden="true" class="hash-link" href="#web-view-ç”Ÿå‘½å‘¨æœŸ" title="Direct link to heading">â€‹</a></h3><p>ç”Ÿå‘½å‘¨æœŸåŒ…æ‹¬ä¸‰éƒ¨åˆ†ï¼š</p><ul><li><code>åˆ›å»º</code>ï¼španel = vscode.window.createWebviewPanel()</li><li><code>æ˜¾ç¤º</code>ï¼španel.webview.html = htmlString</li><li><code>å…³é—­</code>ï¼španel.dispose() ä¸»åŠ¨å…³é—­ï¼Œpanel.onDidDispose è®¾ç½®å…³é—­æ—¶æ¸…ç†çš„å†…å®¹ã€‚</li></ul><div class="codeBlockContainer_K1bP language-ts"><div class="codeBlockContent_hGly ts"><pre tabindex="0" class="prism-code language-ts codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">webViewPanel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> vscode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">ExtensionContext</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 1. ä½¿ç”¨ createWebviewPanel åˆ›å»ºä¸€ä¸ª panelï¼Œç„¶åç»™ panel æ”¾å…¥ html å³å¯å±•ç¤º web view</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> panel </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vscode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">createWebviewPanel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;helloWorld&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;Hello world&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    vscode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">ViewColumn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">One</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// web view æ˜¾ç¤ºä½ç½®</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      enableScripts</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// å…è®¸ JavaScript</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      retainContextWhenHidden</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// åœ¨ hidden çš„æ—¶å€™ä¿æŒä¸å…³é—­</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> innerHtml </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">&lt;h1&gt;Hello Web View&lt;/h1&gt;</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  panel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">webview</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">html</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getWebViewContent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">innerHtml</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 2. å‘¨æœŸæ€§æ”¹å˜ html ä¸­çš„å†…å®¹ï¼Œå› ä¸ºæ˜¯ç›´æ¥ç»™ webview.html èµ‹å€¼ï¼Œæ‰€ä»¥æ˜¯åˆ·æ–°æ•´ä¸ªå†…å®¹</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">changeWebView</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> newData </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">ceil</span><span class="token punctuation" style="color:#393A34">(</span><span class="token known-class-name class-name">Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">random</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    panel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">webview</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">html</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getWebViewContent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">innerHtml</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">&lt;p&gt;</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">newData</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">&lt;/p&gt;</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> interval </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">setInterval</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">changeWebView</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 3. å¯ä»¥é€šè¿‡è®¾ç½® panel.onDidDisposeï¼Œè®© webView åœ¨å…³é—­æ—¶æ‰§è¡Œä¸€äº›æ¸…ç†å·¥ä½œã€‚</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  panel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">onDidDispose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">clearInterval</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">interval</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">subscriptions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getWebViewContent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">body</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pic</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> vscode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Uri</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">&lt;!DOCTYPE html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">&lt;html lang=&quot;en&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">  &lt;head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">    &lt;meta charset=&quot;UTF-8&quot; /&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot; /&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">    &lt;title&gt;Document&lt;/title&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">  &lt;/head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">  &lt;body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">    </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">body</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">    &lt;br /&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">    &lt;img</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">      id=&quot;picture&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">      src=&quot;</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">pic </span><span class="token template-string interpolation operator" style="color:#393A34">||</span><span class="token template-string interpolation"> </span><span class="token template-string interpolation string" style="color:#e3116c">&quot;https://media.giphy.com/media/JIX9t2j0ZTN9S/giphy.gif&quot;</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">      width=&quot;300&quot; /&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">  &lt;/body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">&lt;/html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">  </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><blockquote><ul><li>é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨ Web è§†å›¾ä¸­ç¦ç”¨<code>JavaScript</code>ï¼Œä½†å¯ä»¥é€šè¿‡ä¼ å…¥<code>enableScripts: true</code>é€‰é¡¹è½»æ¾å¯ç”¨ï¼›</li><li>é»˜è®¤æƒ…å†µä¸‹å½“ webview è¢«éšè—æ—¶èµ„æºä¼šè¢«é”€æ¯ï¼Œé€šè¿‡<code>retainContextWhenHidden: true</code>ä¼šä¸€ç›´ä¿å­˜ï¼Œä½†ä¼šå ç”¨è¾ƒå¤§å†…å­˜å¼€é”€ï¼Œä»…åœ¨éœ€è¦æ—¶å¼€å¯ï¼›</li></ul></blockquote><h4 class="anchor anchorWithStickyNavbar_31ik" id="è¯»å–æœ¬åœ°æ–‡ä»¶">è¯»å–æœ¬åœ°æ–‡ä»¶<a aria-hidden="true" class="hash-link" href="#è¯»å–æœ¬åœ°æ–‡ä»¶" title="Direct link to heading">â€‹</a></h4><p>ä¸€èˆ¬æƒ…å†µä¸‹<code>web view</code> æ˜¯ä¸èƒ½ç›´æ¥è®¿é—®æœ¬åœ°æ–‡ä»¶çš„ï¼Œéœ€è¦ä½¿ç”¨ <code>vscode-resource: å¼€å¤´</code>çš„åœ°å€,å’Œ<code>file:</code>ä¸€æ ·ï¼Œ<code>vscode-resource:</code>ä»ç£ç›˜åŠ è½½ç»å¯¹è·¯å¾„çš„èµ„æºã€‚</p><p>åœ¨é«˜äº 1.38 ç‰ˆ VSCode ä¸‹å¯ä»¥ä½¿ç”¨ <code>panel.webview.asWebviewUri(onDiskPath)</code> ç”Ÿæˆå¯¹åº”çš„åœ°å€ï¼Œå¦åˆ™éœ€è¦ä½¿ç”¨ <code>onDiskPath.with({ scheme: &#x27;vscode-resource&#x27; })</code>ã€‚</p><div class="codeBlockContainer_K1bP language-ts"><div class="codeBlockContent_hGly ts"><pre tabindex="0" class="prism-code language-ts codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * è·å–æŸä¸ªæ‰©å±•æ–‡ä»¶ç›¸å¯¹äºwebviewéœ€è¦çš„ä¸€ç§ç‰¹æ®Šè·¯å¾„æ ¼å¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * å½¢å¦‚ï¼švscode-resource:/Users/toonces/projects/vscode-cat-coding/media/cat.gif</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param context ä¸Šä¸‹æ–‡</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param relativePath æ‰©å±•ä¸­æŸä¸ªæ–‡ä»¶ç›¸å¯¹äºæ ¹ç›®å½•çš„è·¯å¾„ï¼Œå¦‚ images/test.jpg</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function-variable function" style="color:#d73a49">getExtensionFileVscodeResource</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> relativePath</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> diskPath </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vscode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Uri</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">file</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">extensionPath</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> relativePath</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> diskPath</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">with</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> scheme</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;vscode-resource&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">toString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>vscode-resource:</code>åªèƒ½è®¿é—®ä»¥ä¸‹ä½ç½®ä¸­çš„èµ„æºï¼š</p><blockquote><ul><li>æ‰©å±•ç¨‹åº<code>å®‰è£…ç›®å½•</code>ä¸­çš„æ–‡ä»¶ã€‚</li><li>ç”¨æˆ·å½“å‰æ´»åŠ¨çš„<code>å·¥ä½œåŒº</code>å†…ã€‚</li><li>å½“ç„¶ï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨<code>dataURI</code>ç›´æ¥åœ¨ Webview ä¸­åµŒå…¥èµ„æºï¼Œè¿™ç§æ–¹å¼æ²¡æœ‰é™åˆ¶ï¼›</li></ul></blockquote><h3 class="anchor anchorWithStickyNavbar_31ik" id="æ¶ˆæ¯é€šä¿¡">æ¶ˆæ¯é€šä¿¡<a aria-hidden="true" class="hash-link" href="#æ¶ˆæ¯é€šä¿¡" title="Direct link to heading">â€‹</a></h3><p>é‡å¤´æˆæ¥äº†ï¼Œ<code>Webview</code>å’Œæ™®é€šç½‘é¡µéå¸¸ç±»ä¼¼ï¼Œä¸èƒ½ç›´æ¥è°ƒç”¨ä»»ä½•<code>VSCode</code>APIï¼Œä½†æ˜¯ï¼Œå®ƒå”¯ä¸€ç‰¹åˆ«ä¹‹å¤„å°±åœ¨äºå¤šäº†ä¸€ä¸ªåå«<code>acquireVsCodeApi</code>çš„æ–¹æ³•ï¼Œæ‰§è¡Œè¿™ä¸ªæ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªè¶…çº§é˜‰å‰²ç‰ˆçš„<code>vscode</code>å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡é‡Œé¢æœ‰ä¸”ä»…æœ‰å¦‚ä¸‹ 3 ä¸ªå¯ä»¥å’Œæ’ä»¶é€šä¿¡çš„ APIï¼š
<img src="http://img.zhangyapeng.club/vscode%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/%E4%B8%83%E7%89%9B%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87/20181013_184810_640_4228.png" alt="vscodeæ’ä»¶å¼€å‘/ä¸ƒç‰›ä¸Šä¼ å›¾ç‰‡"></p><p>æ’ä»¶å’Œ<code>Webview</code>ä¹‹é—´å¦‚ä½•äº’ç›¸é€šä¿¡å‘¢ï¼Ÿ</p><p>æ’ä»¶ç»™<code>Webview</code>å‘é€æ¶ˆæ¯ï¼ˆæ”¯æŒå‘é€ä»»æ„å¯ä»¥è¢«<code>JSON</code>åŒ–çš„æ•°æ®ï¼‰ï¼š</p><div class="codeBlockContainer_K1bP language-javascript"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">panel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">webview</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">postMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> text</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ä½ å¥½ï¼Œæˆ‘æ˜¯å¤§é¹åŒå­¦ï¼&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>Webview</code>ç«¯æ¥æ”¶ï¼š</p><div class="codeBlockContainer_K1bP language-javascript"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;message&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token parameter">event</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> message </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Webviewæ¥æ”¶åˆ°çš„æ¶ˆæ¯ï¼š&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>Webview</code>ä¸»åŠ¨å‘é€æ¶ˆæ¯ç»™æ’ä»¶ï¼š</p><div class="codeBlockContainer_K1bP language-javascript"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">vscode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">postMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> text</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ä½ å¥½ï¼Œæˆ‘æ˜¯Webviewå•Šï¼&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>æ’ä»¶æ¥æ”¶ï¼š</p><div class="codeBlockContainer_K1bP language-javascript"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">panel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">webview</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">onDidReceiveMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;æ’ä»¶æ”¶åˆ°çš„æ¶ˆæ¯ï¼š&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword nil" style="color:#00009f">undefined</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">subscriptions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_31ik" id="ç®€å•é€šä¿¡å°è£…">ç®€å•é€šä¿¡å°è£…<a aria-hidden="true" class="hash-link" href="#ç®€å•é€šä¿¡å°è£…" title="Direct link to heading">â€‹</a></h4><p>Webview ç«¯ï¼š</p><div class="codeBlockContainer_K1bP language-ts"><div class="codeBlockContent_hGly ts"><pre tabindex="0" class="prism-code language-ts codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> callbacks </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// å­˜æ”¾æ‰€æœ‰çš„å›è°ƒå‡½æ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * è°ƒç”¨vscodeåŸç”Ÿapi</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param data å¯ä»¥æ˜¯ç±»ä¼¼ {cmd: &#x27;xxx&#x27;, param1: &#x27;xxx&#x27;}ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æ˜¯ cmd å­—ç¬¦ä¸²</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param cb å¯é€‰çš„å›è°ƒå‡½æ•°</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">callVscode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cb</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> data </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> cmd</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> data </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cb</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// æ—¶é—´æˆ³åŠ ä¸Š5ä½éšæœºæ•°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> cbid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Date</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">now</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token known-class-name class-name">Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">round</span><span class="token punctuation" style="color:#393A34">(</span><span class="token known-class-name class-name">Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">random</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// å°†å›è°ƒå‡½æ•°åˆ†é…ä¸€ä¸ªéšæœºcbidç„¶åå­˜èµ·æ¥ï¼Œåç»­éœ€è¦æ‰§è¡Œçš„æ—¶å€™å†æèµ·æ¥</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    callbacks</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">cbid</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cb</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cbid</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cbid</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  vscode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">postMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">addEventListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;message&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> message </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cmd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// æ¥è‡ªvscodeçš„å›è°ƒ</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;vscodeCallback&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">callbacks</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cbid</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">delete</span><span class="token plain"> callbacks</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cbid</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// æ‰§è¡Œå®Œå›è°ƒåˆ é™¤</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">default</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>æ’ä»¶ç«¯ï¼š</p><div class="codeBlockContainer_K1bP language-ts"><div class="codeBlockContent_hGly ts"><pre tabindex="0" class="prism-code language-ts codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> global </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> projectPath</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> panel </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">panel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">webview</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">onDidReceiveMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">messageHandler</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cmd</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// cmdè¡¨ç¤ºè¦æ‰§è¡Œçš„æ–¹æ³•åç§°</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      messageHandler</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cmd</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">global</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      util</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">showError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">æœªæ‰¾åˆ°åä¸º </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">message</span><span class="token template-string interpolation punctuation" style="color:#393A34">.</span><span class="token template-string interpolation">cmd</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c"> çš„æ–¹æ³•!</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">undefined</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  context</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">subscriptions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * å­˜æ”¾æ‰€æœ‰æ¶ˆæ¯å›è°ƒå‡½æ•°ï¼Œæ ¹æ® message.cmd æ¥å†³å®šè°ƒç”¨å“ªä¸ªæ–¹æ³•ï¼Œ</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * æƒ³è°ƒç”¨ä»€ä¹ˆæ–¹æ³•ï¼Œå°±åœ¨è¿™é‡Œå†™ä¸€ä¸ªå’ŒcmdåŒåçš„æ–¹æ³•å®ç°å³å¯</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> messageHandler </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// å¼¹å‡ºæç¤º</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">alert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">global</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    util</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">showInfo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">info</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// æ˜¾ç¤ºé”™è¯¯æç¤º</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">global</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    util</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">showError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">info</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// å›è°ƒç¤ºä¾‹ï¼šè·å–å·¥ç¨‹å</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">getProjectName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">global</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">invokeCallback</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      global</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">panel</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      message</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      util</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getProjectName</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">global</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">projectPath</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * æ‰§è¡Œå›è°ƒå‡½æ•°</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param {*} panel</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param {*} message</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param {*} resp</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">invokeCallback</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">panel</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> message</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> resp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;å›è°ƒæ¶ˆæ¯ï¼š&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> resp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// é”™è¯¯ç åœ¨400-600ä¹‹é—´çš„ï¼Œé»˜è®¤å¼¹å‡ºé”™è¯¯æç¤º</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> resp </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;object&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    resp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">code</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    resp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">code</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">400</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    resp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">code</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">600</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    util</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">showError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">resp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">message</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;å‘ç”ŸæœªçŸ¥é”™è¯¯ï¼&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  panel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">webview</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">postMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cmd</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;vscodeCallback&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cbid</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> message</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cbid</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> resp</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>æŒ‰ä¸Šè¿°æ–¹æ³•å°è£…ä¹‹åï¼Œä¾‹å¦‚ï¼Œ<code>Webview</code>ç«¯æƒ³è¦æ‰§è¡Œåä¸º<code>openFileInVscode</code>å‘½ä»¤åªéœ€è¦è¿™æ ·ï¼š</p><div class="codeBlockContainer_K1bP language-ts"><div class="codeBlockContent_hGly ts"><pre tabindex="0" class="prism-code language-ts codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">callVscode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> cmd</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;openFileInVscode&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> path</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">package.json</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">alert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ç„¶ååœ¨æ’ä»¶ç«¯çš„ <code>messageHandler</code> å®ç° <code>openFileInVscode</code> æ–¹æ³•å³å¯ï¼Œå…¶å®ƒéƒ½ä¸ç”¨ç®¡ï¼š</p><div class="codeBlockContainer_K1bP language-ts"><div class="codeBlockContent_hGly ts"><pre tabindex="0" class="prism-code language-ts codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> messageHandler </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// çœç•¥å…¶å®ƒæ–¹æ³•</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">openFileInVscode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">global</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    util</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">openFileInVscode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">global</span><span class="token template-string interpolation punctuation" style="color:#393A34">.</span><span class="token template-string interpolation">projectPath</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string string" style="color:#e3116c">/</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">message</span><span class="token template-string interpolation punctuation" style="color:#393A34">.</span><span class="token template-string interpolation">path</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">invokeCallback</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">global</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">panel</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> message</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;æ‰“å¼€æ–‡ä»¶æˆåŠŸï¼&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_31ik" id="çŠ¶æ€ä¿æŒ">çŠ¶æ€ä¿æŒ<a aria-hidden="true" class="hash-link" href="#çŠ¶æ€ä¿æŒ" title="Direct link to heading">â€‹</a></h2><p>å½“webviewç§»åŠ¨åˆ°åå°åˆå†æ¬¡æ˜¾ç¤ºæ—¶ï¼Œwebviewä¸­çš„ä»»ä½•çŠ¶æ€éƒ½å°†ä¸¢å¤±ã€‚</p><p>è§£å†³æ­¤é—®é¢˜çš„æœ€ä½³æ–¹æ³•æ˜¯ä½¿ä½ çš„webviewæ— çŠ¶æ€ï¼Œé€šè¿‡æ¶ˆæ¯ä¼ é€’æ¥ä¿å­˜webviewçš„çŠ¶æ€ã€‚</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="371-state">3.7.1. state<a aria-hidden="true" class="hash-link" href="#371-state" title="Direct link to heading">â€‹</a></h3><p>åœ¨webviewçš„jsä¸­æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>vscode.getState()</code>å’Œ<code>vscode.setState()</code>æ–¹æ³•æ¥ä¿å­˜å’Œæ¢å¤JSONå¯åºåˆ—åŒ–çŠ¶æ€å¯¹è±¡ã€‚å½“webviewè¢«éšè—æ—¶ï¼Œå³ä½¿webviewå†…å®¹æœ¬èº«è¢«ç ´åï¼Œè¿™äº›çŠ¶æ€ä»ç„¶ä¼šä¿å­˜ã€‚å½“ç„¶äº†ï¼Œå½“webviewè¢«é”€æ¯æ—¶ï¼ŒçŠ¶æ€å°†è¢«é”€æ¯ã€‚</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="372-åºåˆ—åŒ–">3.7.2. åºåˆ—åŒ–<a aria-hidden="true" class="hash-link" href="#372-åºåˆ—åŒ–" title="Direct link to heading">â€‹</a></h3><p>é€šè¿‡æ³¨å†Œ<code>WebviewPanelSerializer</code>å¯ä»¥å®ç°åœ¨<code>VScode</code>é‡å¯åè‡ªåŠ¨æ¢å¤ä½ çš„<code>webview</code>ï¼Œå½“ç„¶ï¼Œåºåˆ—åŒ–å…¶å®ä¹Ÿæ˜¯å»ºç«‹åœ¨<code>getState</code>å’Œ<code>setState</code>ä¹‹ä¸Šçš„ã€‚</p><p>æ³¨å†Œæ–¹æ³•ï¼š<code>vscode.window.registerWebviewPanelSerializer</code></p><h3 class="anchor anchorWithStickyNavbar_31ik" id="373-retaincontextwhenhidden">3.7.3. retainContextWhenHidden<a aria-hidden="true" class="hash-link" href="#373-retaincontextwhenhidden" title="Direct link to heading">â€‹</a></h3><p>å¯¹äºå…·æœ‰éå¸¸å¤æ‚çš„UIæˆ–çŠ¶æ€ä¸”æ— æ³•å¿«é€Ÿä¿å­˜å’Œæ¢å¤çš„<code>webview</code>ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨<code>retainContextWhenHidden</code>é€‰é¡¹ã€‚è®¾ç½®<code>retainContextWhenHidden: true</code>åå³ä½¿webviewè¢«éšè—åˆ°åå°å…¶çŠ¶æ€ä¹Ÿä¸ä¼šä¸¢å¤±ã€‚</p><p>å°½ç®¡<code>retainContextWhenHidden</code>å¾ˆæœ‰å¸å¼•åŠ›ï¼Œä½†å®ƒéœ€è¦å¾ˆé«˜çš„å†…å­˜å¼€é”€ï¼Œä¸€èˆ¬å»ºè®®åœ¨å®åœ¨æ²¡åŠæ³•çš„æ—¶å€™æ‰å¯ç”¨ã€‚
<code>getState</code>å’Œ<code>setState</code>æ˜¯æŒä¹…åŒ–çš„é¦–é€‰æ–¹å¼ï¼Œå› ä¸ºå®ƒä»¬çš„æ€§èƒ½å¼€é”€è¦æ¯”<code>retainContextWhenHidden</code>ä½å¾—å¤šã€‚</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="è°ƒè¯•-web-view">è°ƒè¯• web view<a aria-hidden="true" class="hash-link" href="#è°ƒè¯•-web-view" title="Direct link to heading">â€‹</a></h4><p>å¯ä»¥ä½¿ç”¨ä¸‹é¢<code>web view develop tool</code> å‘½ä»¤ã€‚</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="å‚è€ƒ">å‚è€ƒ<a aria-hidden="true" class="hash-link" href="#å‚è€ƒ" title="Direct link to heading">â€‹</a></h2><ul><li><p><a href="https://zhuanlan.zhihu.com/p/99198980" target="_blank" rel="noopener noreferrer">VSCode æ’ä»¶å¼€å‘å…¥é—¨</a></p></li><li><p><a href="https://zhuanlan.zhihu.com/p/90091936" target="_blank" rel="noopener noreferrer">å¼€å‘ä¸€ä¸ªçˆ†æ¬¾ VSCode æ’ä»¶</a></p></li><li><p><a href="http://blog.haoji.me/vscode-plugin-webview.html" target="_blank" rel="noopener noreferrer">VSCode æ’ä»¶å¼€å‘å…¨æ”»ç•¥</a></p></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/dapengdouyu/docs/tree/master/docs/program/vscodeæ’ä»¶å¼€å‘/ä¸ƒç‰›ä¸Šä¼ å›¾ç‰‡.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2021-12-20T08:39:48.000Z">12/20/2021</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/program/vscodeæ’ä»¶å¼€å‘/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->index</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/program/vue/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">index<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#vscode-ç»„æˆç»“æ„" class="table-of-contents__link toc-highlight">VSCode ç»„æˆç»“æ„</a><ul><li><a href="#monaco-editor" class="table-of-contents__link toc-highlight">Monaco Editor</a></li><li><a href="#extension-host" class="table-of-contents__link toc-highlight">Extension Host</a></li><li><a href="#language-server-protocol--debug-adapter-protocol" class="table-of-contents__link toc-highlight">Language Server Protocol &amp; Debug Adapter Protocol</a></li></ul></li><li><a href="#vscode-æä¾›äº†å“ªäº›å¼€æ”¾èƒ½åŠ›" class="table-of-contents__link toc-highlight">vscode æä¾›äº†å“ªäº›å¼€æ”¾èƒ½åŠ›ï¼Ÿ</a></li><li><a href="#å¦‚ä½•ç¼–å†™ä¸€ä¸ª-vscode-æ’ä»¶å‘¢" class="table-of-contents__link toc-highlight">å¦‚ä½•ç¼–å†™ä¸€ä¸ª vscode æ’ä»¶å‘¢ï¼Ÿ</a><ul><li><a href="#activation-eventsæ’ä»¶çš„æ¿€æ´»æ—¶æœº" class="table-of-contents__link toc-highlight">Activation Events(æ’ä»¶çš„æ¿€æ´»æ—¶æœº)</a></li><li><a href="#contribution-pointsæ’ä»¶çš„è´¡çŒ®ç‚¹" class="table-of-contents__link toc-highlight">contribution points(æ’ä»¶çš„è´¡çŒ®ç‚¹)</a></li></ul></li><li><a href="#api" class="table-of-contents__link toc-highlight">Api</a><ul><li><a href="#å…¥å£æ–‡ä»¶" class="table-of-contents__link toc-highlight">å…¥å£æ–‡ä»¶</a></li><li><a href="#unit-test" class="table-of-contents__link toc-highlight">Unit Test</a></li><li><a href="#api-è®¾è®¡çš„æ¨¡å¼" class="table-of-contents__link toc-highlight">API è®¾è®¡çš„æ¨¡å¼</a></li><li><a href="#cancellation-tokens" class="table-of-contents__link toc-highlight">Cancellation Tokens</a></li><li><a href="#disposables" class="table-of-contents__link toc-highlight">Disposables</a></li><li><a href="#events" class="table-of-contents__link toc-highlight">Events</a></li><li><a href="#web-view-ç”Ÿå‘½å‘¨æœŸ" class="table-of-contents__link toc-highlight">web view ç”Ÿå‘½å‘¨æœŸ</a></li><li><a href="#æ¶ˆæ¯é€šä¿¡" class="table-of-contents__link toc-highlight">æ¶ˆæ¯é€šä¿¡</a></li></ul></li><li><a href="#çŠ¶æ€ä¿æŒ" class="table-of-contents__link toc-highlight">çŠ¶æ€ä¿æŒ</a><ul><li><a href="#371-state" class="table-of-contents__link toc-highlight">3.7.1. state</a></li><li><a href="#372-åºåˆ—åŒ–" class="table-of-contents__link toc-highlight">3.7.2. åºåˆ—åŒ–</a></li><li><a href="#373-retaincontextwhenhidden" class="table-of-contents__link toc-highlight">3.7.3. retainContextWhenHidden</a></li></ul></li><li><a href="#å‚è€ƒ" class="table-of-contents__link toc-highlight">å‚è€ƒ</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 dapeng (å¼ äºšé¹)  <a href="https://beian.miit.gov.cn/#/Integrated/index">äº¬ICPå¤‡20028300å·</a></div></div></div></footer></div>
<script src="/assets/js/runtime~main.e2552c1f.js"></script>
<script src="/assets/js/main.d3677d32.js"></script>
</body>
</html>