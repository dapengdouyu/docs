<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="Dapengçš„åšå®¢ Blog RSS Feed">
<script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?7dda2565ba246ecd62878c13153e2941",e.defer=!0;var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
<meta name="baidu-site-verification" content="IXU12YQUjF">
<link rel="preconnect" href="https://hmcdn.baidu.com">
<link rel="stylesheet" href="https://cansiny.oss-cn-shanghai.aliyuncs.com/assets/fonts.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><title data-react-helmet="true">6ã€js parser çš„å†å² - Dapengçš„åšå®¢</title><meta data-react-helmet="true" property="og:url" content="https://zhangyapeng.gitee.io/docs/books/babel/6ã€js parser çš„å†å²"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="6ã€js parser çš„å†å² - Dapengçš„åšå®¢"><meta data-react-helmet="true" name="description" content="å‰é¢æˆ‘ä»¬å­¦ä¹ äº† babel çš„ parser å’Œ ASTï¼Œbabel çš„ parser æ˜¯åŸºäº acorn æ‰©å±•è€Œæ¥çš„ï¼Œè€Œ acorn ä¹Ÿä¸æ˜¯æœ€æ—©çš„ js parserï¼Œjs parser çš„å†å²æ˜¯æ€æ ·çš„ï¼Ÿ å„ç§ parser ä¹‹é—´çš„å…³ç³»æ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿè¿™èŠ‚æˆ‘ä»¬æ¥æ¢³ç†ä¸€ä¸‹ã€‚"><meta data-react-helmet="true" property="og:description" content="å‰é¢æˆ‘ä»¬å­¦ä¹ äº† babel çš„ parser å’Œ ASTï¼Œbabel çš„ parser æ˜¯åŸºäº acorn æ‰©å±•è€Œæ¥çš„ï¼Œè€Œ acorn ä¹Ÿä¸æ˜¯æœ€æ—©çš„ js parserï¼Œjs parser çš„å†å²æ˜¯æ€æ ·çš„ï¼Ÿ å„ç§ parser ä¹‹é—´çš„å…³ç³»æ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿè¿™èŠ‚æˆ‘ä»¬æ¥æ¢³ç†ä¸€ä¸‹ã€‚"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://zhangyapeng.gitee.io/docs/books/babel/6ã€js parser çš„å†å²"><link data-react-helmet="true" rel="alternate" href="https://zhangyapeng.gitee.io/docs/books/babel/6ã€js parser çš„å†å²" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://zhangyapeng.gitee.io/docs/books/babel/6ã€js parser çš„å†å²" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.ffac1681.css">
<link rel="preload" href="/assets/js/runtime~main.beccc056.js" as="script">
<link rel="preload" href="/assets/js/main.f67a5996.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.jpg" alt="DAPENG" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.jpg" alt="DAPENG" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">DAPENG</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">åšå®¢</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/tags/java-script">JavaScript</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link">å‰ç«¯</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/program/javascript/index">Javascript</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link">é˜…è¯»</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/books/babel/index">babel</a></li></ul></div><a href="https://gitee.com/zhangyapeng" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>gitee<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ğŸŒ</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><main class="docMainContainer_3ufF docMainContainerEnhanced_3NYZ"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1 class="h1Heading_27L5">6ã€js parser çš„å†å²</h1></header><p>å‰é¢æˆ‘ä»¬å­¦ä¹ äº† babel çš„ parser å’Œ ASTï¼Œbabel çš„ parser æ˜¯åŸºäº acorn æ‰©å±•è€Œæ¥çš„ï¼Œè€Œ acorn ä¹Ÿä¸æ˜¯æœ€æ—©çš„ js parserï¼Œjs parser çš„å†å²æ˜¯æ€æ ·çš„ï¼Ÿ å„ç§ parser ä¹‹é—´çš„å…³ç³»æ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿè¿™èŠ‚æˆ‘ä»¬æ¥æ¢³ç†ä¸€ä¸‹ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="js-parserçš„å†å²"></a>JS parserçš„å†å²<a class="hash-link" href="#js-parserçš„å†å²" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="spidermonkey-å’Œ-estree-æ ‡å‡†"></a>SpiderMonkey å’Œ estree æ ‡å‡†<a class="hash-link" href="#spidermonkey-å’Œ-estree-æ ‡å‡†" title="Direct link to heading">#</a></h3><p>åœ¨ nodejs å‡ºç°ä¹‹åï¼Œå‰ç«¯å¯ä»¥ç”¨ nodejs æ¥åšä¸€äº›å·¥ç¨‹åŒ–çš„äº‹æƒ…ï¼Œä¹Ÿå°±æœ‰äº†å¯¹ js parser çš„éœ€æ±‚ï¼Œå½“æ—¶ Mozilla åœ¨ MDN ä¸Šå…¬å¸ƒäº† SpiderMonkeyï¼ˆc++ å†™çš„ js å¼•æ“ï¼‰çš„ parser api å’Œ AST æ ‡å‡†ï¼Œæ‰€ä»¥å½“æ—¶æœ€æ—©çš„ JS parser ---- <a href="https://github.com/jquery/esprima" target="_blank" rel="noopener noreferrer">esprima</a> å°±æ˜¯åŸºäº SpiderMonkey çš„ AST æ ‡å‡†æ¥å®ç°çš„ï¼Œåæ¥å½¢æˆäº† <a href="https://github.com/estree/estree" target="_blank" rel="noopener noreferrer">estree æ ‡å‡†</a>ã€‚ å½“æ—¶å¾ˆå¤šçš„å‰ç«¯é¢†åŸŸçš„å·¥å…·éƒ½åŸºäº esprimaã€‚</p><p>ä½†æ˜¯åˆ°äº† 2015 å¹´ä¹‹åï¼Œes æ ‡å‡†ä¸€å¹´ä¸€ä¸ªç‰ˆæœ¬ï¼Œè€Œ esprima çš„æ›´æ–°é€Ÿåº¦è·Ÿä¸ä¸Šï¼Œå®ƒè·Ÿä¸ä¸Šä¹Ÿå°±å¯¼è‡´äº†ä¾èµ–å®ƒçš„ä¸€ç³»åˆ—å·¥å…·éƒ½è·Ÿä¸ä¸Šï¼Œæ‰€ä»¥ eslint å°± fork äº†ä¸€ä»½ esprimaï¼Œåšäº†ä¸€äº›æ‰©å±•ï¼Œæ¥è‡ªå·±å®ç°æ–°è¯­æ³•çš„ parseï¼Œè¿™å°±æ˜¯ espreeï¼Œå®ƒä¾ç„¶æ˜¯ estree æ ‡å‡†çš„ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="acorn"></a>acorn<a class="hash-link" href="#acorn" title="Direct link to heading">#</a></h3><p>åé¢å‡ºç°äº† <a href="https://github.com/acornjs/acorn" target="_blank" rel="noopener noreferrer">acorn</a>ï¼Œä¹Ÿæ˜¯ estree æ ‡å‡†çš„å®ç°ï¼Œä½†æ˜¯ä»–çš„é€Ÿåº¦æ¯” esprima å¿«ï¼Œè€Œä¸”æ”¯æŒæ’ä»¶ï¼Œå¯ä»¥é€šè¿‡æ’ä»¶æ‰©å±•è¯­æ³•æ”¯æŒã€‚æ­£æ˜¯é€Ÿåº¦å¿«åŠ ä¸Šæ”¯æŒæ’ä»¶è®©å¾ˆå¤šå·¥å…·éƒ½è½¬è€Œä½¿ç”¨ acornã€‚</p><p>eslint çš„ parser ---- <a href="https://github.com/eslint/espree" target="_blank" rel="noopener noreferrer">espree</a> æœ¬æ¥æ˜¯ fork è‡ª esprimaï¼Œä½†åæ¥ espree 2.0 åŸºäº acorn é‡æ–°å®ç°äº†ï¼Œä¹Ÿä½¿ç”¨ acorn çš„æ’ä»¶æœºåˆ¶æ¥æ‰©å±•è¯­æ³•ã€‚</p><p>babel parser(babylon) ä¹Ÿæ˜¯åŸºäº acornï¼Œå¹¶ä¸”å¯¹ AST èŠ‚ç‚¹å’Œå±æ€§éƒ½åšäº†æ‰©å±•ï¼Œä¹Ÿæä¾›äº†ä¸€äº›æ”¯æŒ typescriptã€jsxã€flow çš„æ’ä»¶ï¼ˆå°±æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨ \@babel/parser çš„ plugins é‡Œé¢æŒ‡å®šçš„é‚£äº›ï¼‰ã€‚</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="js-parser-ä¹‹é—´çš„å…³ç³»"></a>js parser ä¹‹é—´çš„å…³ç³»<a class="hash-link" href="#js-parser-ä¹‹é—´çš„å…³ç³»" title="Direct link to heading">#</a></h3><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9f30072e7a774fbf85539daedb8813ad~tplv-k3u1fbpfcp-watermark.image"></p><p>å®ƒä»¬çš„å…³ç³»å¦‚å›¾æ‰€ç¤ºï¼Œestree æ ‡å‡†æ˜¯åŸºäº SpiderMonkey çš„ AST æ ‡å‡†æ‰©å±•çš„ï¼Œå®ƒçš„å®ç°æœ‰ esprimaã€acorn ç­‰ï¼Œç°åœ¨ espreeã€babel parser éƒ½æ˜¯åŸºäºacornåšçš„æ‰©å±•ï¼Œå› ä¸º acorn æä¾›äº†æ’ä»¶æœºåˆ¶ã€‚</p><p>å½“ç„¶ä¹Ÿä¸æ˜¯æ‰€æœ‰çš„ js parser éƒ½æ˜¯ estree æ ‡å‡†çš„ï¼Œæ¯”å¦‚ terserã€typescript ç­‰éƒ½æœ‰è‡ªå·±çš„ AST æ ‡å‡†ã€‚</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="babel-parser-å¯¹-estree-ast-çš„æ‰©å±•"></a>babel parser å¯¹ estree AST çš„æ‰©å±•<a class="hash-link" href="#babel-parser-å¯¹-estree-ast-çš„æ‰©å±•" title="Direct link to heading">#</a></h4><p>babel åŸºäº acorn æ’ä»¶å¯¹ estree AST åšäº†å¦‚ä¸‹æ‰©å±•</p><ul><li>æŠŠ Literal æ›¿æ¢æˆäº† StringLiteralã€NumericLiteralã€ BigIntLiteralã€ BooleanLiteralã€ NullLiteralã€ RegExpLiteral</li><li>æŠŠ Property æ›¿æ¢æˆäº† ObjectProperty å’Œ ObjectMethod</li><li>æŠŠ MethodDefinition æ›¿æ¢æˆäº† ClassMethod</li><li>Program å’Œ BlockStatement æ”¯æŒäº† directives å±æ€§ï¼Œä¹Ÿå°±æ˜¯ &#x27;use strict&#x27; ç­‰æŒ‡ä»¤çš„è§£æï¼Œå¯¹åº”çš„ ast æ˜¯ Directive å’Œ DirectiveLiteral</li><li>ChainExpression æ›¿æ¢ä¸ºäº† ObjectMemberExpression å’Œ OptionalCallExpression</li><li>ImportExpression æ›¿æ¢ä¸ºäº† CallExpression å¹¶ä¸” callee å±æ€§è®¾ç½®ä¸º Import</li></ul><p>è¿™äº›å¯ä»¥åœ¨ <a href="https://babeljs.io/docs/en/babel-parser#output" target="_blank" rel="noopener noreferrer">babel parser çš„æ–‡æ¡£</a>é‡Œçœ‹åˆ°ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="acornæ’ä»¶"></a>acornæ’ä»¶<a class="hash-link" href="#acornæ’ä»¶" title="Direct link to heading">#</a></h2><p>babel parser åŸºäº acorn æ‰©å±•äº†ä¸€äº›è¯­æ³•ï¼Œé‚£å®ƒæ˜¯æ€ä¹ˆæ‰©å±•çš„å‘¢ï¼Ÿ æˆ‘ä»¬å†™ä¸€ä¸ª acorn æ’ä»¶æ¥æ„Ÿå—ä¸€ä¸‹ã€‚</p><p>acorn ä¸»è¦æ˜¯ä¸€ä¸ª Parser ç±»ï¼Œä¸åŒçš„æ–¹æ³•å®ç°äº†ä¸åŒçš„é€»è¾‘ï¼Œæ’ä»¶æ‰©å±•å°±æ˜¯ç»§æ‰¿è¿™ä¸ª Parserï¼Œé‡å†™ä¸€äº›æ–¹æ³•ã€‚</p><p>acorn çš„ api å¦‚ä¸‹ï¼Œå…¶ä¸­ acorn-jsxã€acorn-bigint å°±æ˜¯ acorn æ’ä»¶</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token maybe-class-name">Parser</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;acorn&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">MyParser</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">Parser</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">extend</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;acorn-jsx&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;acorn-bigint&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">MyParser</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;// Some bigint + JSX code&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>æ’ä»¶æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ¥æ”¶ä¹‹å‰çš„ Parserï¼Œè¿”å›æ‰©å±•ä»¥åçš„ Parser</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method-variable function-variable method function property-access" style="color:#d73a49">exports</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">noisyReadToken</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">Parser</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">extends</span><span class="token plain"> </span><span class="token maybe-class-name">Parser</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">readToken</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">code</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Reading a token!&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">readToken</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">code</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>æ¥ä¸‹æ¥æˆ‘ä»¬å†™ä¸€ä¸ª acorn æ’ä»¶ï¼š</p><blockquote><p>ç»™ javascript ä¸€ä¸ªå…³é”®å­— guangï¼Œå¯ä»¥ä½œä¸º statement å•ç‹¬ä½¿ç”¨</p></blockquote><p>æˆ‘ä»¬çŸ¥é“ parse çš„è¿‡ç¨‹å…¶å®å°±æ˜¯<code>åˆ†è¯</code> + <code>ç»„è£… AST</code>è¿™ä¸¤æ­¥ï¼ˆä¸€èˆ¬å«è¯æ³•åˆ†æå’Œè¯­æ³•åˆ†æï¼‰ï¼Œæˆ‘ä»¬åªè¦å®ç°è¿™ä¸¤æ­¥å°±å¯ä»¥äº†ã€‚</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="åˆ†è¯ï¼ˆè¯æ³•åˆ†æï¼‰"></a>åˆ†è¯ï¼ˆè¯æ³•åˆ†æï¼‰<a class="hash-link" href="#åˆ†è¯ï¼ˆè¯æ³•åˆ†æï¼‰" title="Direct link to heading">#</a></h4><p>æˆ‘ä»¬æ˜¯æƒ³å¢åŠ ä¸€ä¸ªå…³é”®å­—ï¼Œacorn æœ‰ keywords å±æ€§ï¼Œæ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨æ¥åšå…³é”®å­—æ‹†åˆ†ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡å†™ keywords å±æ€§å°±å¯ä»¥ã€‚å¹¶ä¸”è¿˜è¦ä¸ºæ–°çš„å…³é”®å­—æ³¨å†Œä¸€ä¸ª token ç±»å‹ã€‚</p><p>acorn Parser çš„å…¥å£æ–¹æ³•æ˜¯ parseï¼Œæˆ‘ä»¬è¦åœ¨ parse æ–¹æ³•é‡Œé¢è®¾ç½® keywordsã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">program</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> newKeywords </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this const class extends export import super&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    newKeywords </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot; guang&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">// å¢åŠ ä¸€ä¸ªå…³é”®å­—</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">keywords</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">RegExp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;^(?:&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> newKeywords</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa"> </span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-flags" style="color:#36acaa">g</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;|&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;)$&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">program</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ç„¶åæ³¨å†Œä¸€ä¸ªæ–°çš„ token ç±»å‹æ¥æ ‡è¯†å®ƒ</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token maybe-class-name">Parser</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">acorn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">keywordTypes</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;guang&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">TokenType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;guang&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">keyword</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;guang&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>è¿™æ · acorn å°±ä¼šåœ¨ parse çš„æ—¶å€™åˆ†å‡º <code>guang</code> è¿™ä¸ªå…³é”®å­—</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ç»„è£…astï¼ˆè¯­æ³•åˆ†æï¼‰"></a>ç»„è£…ASTï¼ˆè¯­æ³•åˆ†æï¼‰<a class="hash-link" href="#ç»„è£…astï¼ˆè¯­æ³•åˆ†æï¼‰" title="Direct link to heading">#</a></h4><p>å…‰åˆ†å‡º token æ˜¯æ²¡æ„ä¹‰çš„ï¼Œè¦ç»„è£…åˆ° AST ä¸­ã€‚</p><p>acorn åœ¨ parse åˆ°ä¸åŒç±»å‹çš„èŠ‚ç‚¹ä¼šè°ƒç”¨ä¸åŒçš„ parseXxx æ–¹æ³•ï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯åœ¨ statement é‡Œé¢ç”¨ï¼Œé‚£ä¹ˆå°±è¦é‡å†™ parseStatement æ–¹æ³•ï¼Œåœ¨é‡Œé¢ç»„è£…æ–°çš„ statement èŠ‚ç‚¹ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">parseStatement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">context</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> topLevel</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> exports</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> tokenType </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">type</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tokenType </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token maybe-class-name">Parser</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">acorn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">keywordTypes</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;guang&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> node </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">startNode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">finishNode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">value</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;guang&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;GuangStatement&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">parseStatement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> topLevel</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> exports</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>this.type æ˜¯å½“å‰å¤„ç†åˆ°çš„ token çš„ç±»å‹ï¼Œ this.next æ˜¯æ¶ˆè´¹è¿™ä¸ª tokenï¼Œæˆ‘ä»¬è¯†åˆ«å‡º token çš„ç±»å‹ä¸º guang çš„æ—¶å€™ï¼Œå°±ç»„è£…æˆä¸€ä¸ª ASTã€‚</p><p>é€šè¿‡ this.startNode() åˆ›å»ºä¸€ä¸ªæ–°çš„ASTèŠ‚ç‚¹ï¼Œç„¶å this.next() æ¶ˆè´¹æ‰è¿™ä¸ª tokenï¼Œä¹‹åè¿”å›æ–°çš„ AST èŠ‚ç‚¹ã€‚</p><p>å¦‚æœä¸æ˜¯æˆ‘ä»¬æ‰©å±•çš„ tokenï¼Œåˆ™è°ƒç”¨çˆ¶ç±»çš„ parseStatement å¤„ç†ã€‚</p><p>è¿™æ ·èƒ½æˆåŠŸåˆ†å‡ºtokenï¼Œä½†æ˜¯æœ€å¥½æŠŠå®ƒç‹¬ç«‹æˆä¸€ä¸ªæ–¹æ³•ï¼Œè¿™æ ·å­ç±»å¯ä»¥è¦†ç›–è¿™ä¸ªæ–¹æ³•æ¥å¯¹ parse é€»è¾‘åšä¿®æ”¹ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">parseStatement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">context</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> topLevel</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> exports</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> tokenType </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">type</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tokenType </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token maybe-class-name">Parser</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">acorn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">keywordTypes</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;guang&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> node </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">startNode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">parseGuangStatement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">node</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">parseStatement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> topLevel</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> exports</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">parseGuangStatement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">node</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">finishNode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">value</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;guang&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;GuangStatement&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> acorn </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;acorn&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">Parser</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> acorn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Parser</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">TokenType</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> acorn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">TokenType</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">Parser</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">acorn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">keywordTypes</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;guang&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">TokenType</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;guang&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">keyword</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;guang&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">wordsRegexp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">words</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">RegExp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;^(?:&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> words</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa"> </span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-flags" style="color:#36acaa">g</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;|&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;)$&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">guangKeyword</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">Parser</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">extends</span><span class="token plain"> </span><span class="token maybe-class-name">Parser</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">program</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> newKeywords </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this const class extends export import super&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      newKeywords </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot; guang&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">keywords</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">RegExp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;^(?:&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> newKeywords</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa"> </span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-flags" style="color:#36acaa">g</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;|&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;)$&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">program</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">parseStatement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">context</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> topLevel</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> exports</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> starttype </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">type</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">starttype </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token maybe-class-name">Parser</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">acorn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">keywordTypes</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;guang&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> node </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">startNode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">parseGuangStatement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">node</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">parseStatement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> topLevel</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> exports</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">parseGuangStatement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">node</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">finishNode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">value</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;guang&#x27;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;GuangStatement&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token comment" style="color:#999988;font-style:italic">//æ–°å¢åŠ çš„sshè¯­å¥</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> newParser </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">Parser</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">extend</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">guangKeyword</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>æˆ‘ä»¬æ‰§è¡Œä¸‹è¯•ä¸‹æ•ˆæœ</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> newParser </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">Parser</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">extend</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">guangKeywordPlugin</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> program </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c"></span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">    guang</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c">    const a = 1</span></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c"></span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> ast </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> newParser</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">program</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ast</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>äº§ç”Ÿçš„ASTå¦‚ä¸‹ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token maybe-class-name">Node</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Program&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  start</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">27</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  body</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> value</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;guang&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;GuangStatement&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> end</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token maybe-class-name">Node</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;VariableDeclaration&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      start</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      end</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">26</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      declarations</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token known-class-name class-name">Array</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      kind</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;const&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  sourceType</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;script&#x27;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>å°±è¿™æ ·æˆ‘ä»¬å®ç°äº†æ–°çš„ AST èŠ‚ç‚¹ã€‚</p><p>é€šè¿‡è¿™ä¸ªç®€å•çš„ä¾‹å­ï¼Œæˆ‘ä»¬èƒ½å¤§æ¦‚ç†è§£ babel æ˜¯æ€ä¹ˆåŸºäº acorn å®ç° typescriptã€jsxã€flow è¯­æ³•è§£æçš„äº†ã€‚</p><p>æ¯”å¦‚ Literal æ‰©å±•äº† StringLiteralã€NumericLiteral ç­‰è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°±å¯ä»¥è‡ªå·±å®ç°ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">parseLiteral</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter operator" style="color:#393A34">...</span><span class="token parameter">args</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> node </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">parseLiteral</span><span class="token punctuation" style="color:#393A34">(</span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">switch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> node</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;number&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            node</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;NumericLiteral&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword control-flow" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;string&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            node</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;StringLiteral&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword control-flow" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain">  node</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ€»ç»“"></a>æ€»ç»“<a class="hash-link" href="#æ€»ç»“" title="Direct link to heading">#</a></h2><p>è¿™ä¸€èŠ‚æˆ‘ä»¬äº†è§£äº† js parser çš„å†å²ï¼Œä» SpiderMonkey çš„ AST æ ‡å‡†å¼€å§‹ï¼Œæ‰©å±•åˆ° espree çš„æ ‡å‡†ï¼Œæœ€æ—©çš„ estree æ ‡å‡†çš„å®ç°æ˜¯ esprimaï¼Œä½†æ˜¯éšç€ es2015 å¼€å§‹ä¸€å¹´ä¸€ä¸ªç‰ˆæœ¬ï¼Œesprima çš„è¿­ä»£é€Ÿåº¦é€æ¸è·Ÿä¸ä¸Šäº†ï¼Œè¿™æ—¶å€™ acorn æµè¡Œèµ·æ¥ï¼Œå› ä¸ºé€Ÿåº¦æ›´å¿«ï¼Œè€Œä¸”æ”¯æŒæ’ä»¶æ‰©å±•ï¼Œäºæ˜¯ espreeã€babel parser(babylon) ç­‰éƒ½åŸºäº acorn æ¥å®ç°å„è‡ªçš„ parserã€‚è™½ç„¶ estree ç³»åˆ—çš„ js parser æŒºå¤šçš„ï¼Œä½†ä¹Ÿä¸æ˜¯å…¨éƒ¨ï¼Œterserã€typescript ç­‰éƒ½æ˜¯ç”¨è‡ªå·±çš„ASTã€‚</p><p>å­¦å®Œè¿™ä¸€èŠ‚ï¼Œæˆ‘ä»¬æ›´å…¨é¢çš„äº†è§£äº† js parser çš„å†å²ï¼Œå¯¹å„ç§å·¥å…·æ‰€ç”¨çš„ parser ä¹‹é—´çš„å…³ç³»æœ‰äº†ä¸€å®šçš„äº†è§£ï¼Œå¹¶ä¸”è¿˜çŸ¥é“äº† acorn çš„è¯­æ³•æ’ä»¶è¯¥æ€ä¹ˆå†™ã€‚</p><p>ï¼ˆä»£ç åœ¨<a href="https://github.com/QuarkGluonPlasma/babel-plugin-exercize" target="_blank" rel="noopener noreferrer">è¿™é‡Œ</a>ï¼Œå»ºè®® git clone ä¸‹æ¥é€šè¿‡ node è·‘ä¸€ä¸‹ï¼‰</p></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://gitee.com/zhangyapeng/doc/tree/master/docs/books/babel/6ã€js parser çš„å†å².md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF">Last updated on <b><time datetime="2021-10-09T08:10:49.000Z">10/9/2021</time></b></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#js-parserçš„å†å²" class="table-of-contents__link">JS parserçš„å†å²</a><ul><li><a href="#spidermonkey-å’Œ-estree-æ ‡å‡†" class="table-of-contents__link">SpiderMonkey å’Œ estree æ ‡å‡†</a></li><li><a href="#acorn" class="table-of-contents__link">acorn</a></li><li><a href="#js-parser-ä¹‹é—´çš„å…³ç³»" class="table-of-contents__link">js parser ä¹‹é—´çš„å…³ç³»</a></li></ul></li><li><a href="#acornæ’ä»¶" class="table-of-contents__link">acornæ’ä»¶</a></li><li><a href="#æ€»ç»“" class="table-of-contents__link">æ€»ç»“</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 dapeng (å¼ äºšé¹) Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.beccc056.js"></script>
<script src="/assets/js/main.f67a5996.js"></script>
</body>
</html>