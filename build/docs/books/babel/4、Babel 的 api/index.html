<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="Dapengçš„åšå®¢ Blog RSS Feed">
<script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?7dda2565ba246ecd62878c13153e2941",e.defer=!0;var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
<meta name="baidu-site-verification" content="IXU12YQUjF">
<link rel="preconnect" href="https://hmcdn.baidu.com">
<link rel="stylesheet" href="https://cansiny.oss-cn-shanghai.aliyuncs.com/assets/fonts.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><title data-react-helmet="true">4ã€Babel çš„ api - Dapengçš„åšå®¢</title><meta data-react-helmet="true" property="og:url" content="https://zhangyapeng.gitee.io/docs/books/babel/4ã€Babel çš„ api"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="4ã€Babel çš„ api - Dapengçš„åšå®¢"><meta data-react-helmet="true" name="description" content="å­¦ä¹ äº† babel çš„ç¼–è¯‘æµç¨‹å’Œ AST ä¹‹åï¼Œæˆ‘ä»¬æ¥å­¦ä¹ ä¸‹ babel çš„ apiï¼Œé€šè¿‡è¿™äº› api æ¥æ“ä½œ ASTï¼Œå®Œæˆä»£ç çš„è½¬æ¢ã€‚"><meta data-react-helmet="true" property="og:description" content="å­¦ä¹ äº† babel çš„ç¼–è¯‘æµç¨‹å’Œ AST ä¹‹åï¼Œæˆ‘ä»¬æ¥å­¦ä¹ ä¸‹ babel çš„ apiï¼Œé€šè¿‡è¿™äº› api æ¥æ“ä½œ ASTï¼Œå®Œæˆä»£ç çš„è½¬æ¢ã€‚"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://zhangyapeng.gitee.io/docs/books/babel/4ã€Babel çš„ api"><link data-react-helmet="true" rel="alternate" href="https://zhangyapeng.gitee.io/docs/books/babel/4ã€Babel çš„ api" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://zhangyapeng.gitee.io/docs/books/babel/4ã€Babel çš„ api" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.ffac1681.css">
<link rel="preload" href="/assets/js/runtime~main.beccc056.js" as="script">
<link rel="preload" href="/assets/js/main.f67a5996.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.jpg" alt="DAPENG" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.jpg" alt="DAPENG" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">DAPENG</b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">åšå®¢</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/tags/java-script">JavaScript</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link">å‰ç«¯</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/program/javascript/index">Javascript</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link">é˜…è¯»</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/books/babel/index">babel</a></li></ul></div><a href="https://gitee.com/zhangyapeng" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>gitee<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ğŸŒ</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><main class="docMainContainer_3ufF docMainContainerEnhanced_3NYZ"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1 class="h1Heading_27L5">4ã€Babel çš„ api</h1></header><p>å­¦ä¹ äº† babel çš„ç¼–è¯‘æµç¨‹å’Œ AST ä¹‹åï¼Œæˆ‘ä»¬æ¥å­¦ä¹ ä¸‹ babel çš„ apiï¼Œé€šè¿‡è¿™äº› api æ¥æ“ä½œ ASTï¼Œå®Œæˆä»£ç çš„è½¬æ¢ã€‚</p><blockquote><p>æ³¨æ„ï¼Œæˆ‘ä»¬å­¦ä¹ çš„ api æ˜¯ babel 7.x çš„ï¼Œbabel 6 çš„ api è¿˜æ²¡æœ‰æŒ‰ç…§ scope æ¥åˆ’åˆ†ï¼Œæ˜¯ babel-parser è¿™ç§ï¼Œè€Œ babel 7 å˜æˆäº†\@babel/parser è¿™ç§ã€‚ä½†å…·ä½“ api å·®ä¸å¤šï¼Œæˆ‘ä»¬å­¦çš„æ˜¯ä¸€äº›åŸç†æ€§çš„ä¸œè¥¿ï¼Œè¿™äº›ä¸œè¥¿åœ¨ç‰ˆæœ¬è¿­ä»£ä¸­æ˜¯ä¸ä¼šå˜çš„ã€‚</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="babel-çš„-api-æœ‰å“ªäº›"></a>babel çš„ api æœ‰å“ªäº›<a class="hash-link" href="#babel-çš„-api-æœ‰å“ªäº›" title="Direct link to heading">#</a></h2><p>æˆ‘ä»¬çŸ¥é“ babel çš„ç¼–è¯‘æµç¨‹åˆ†ä¸ºä¸‰æ­¥ï¼šparseã€transformã€generateï¼Œæ¯ä¸€æ­¥éƒ½æš´éœ²äº†ä¸€äº› api å‡ºæ¥ã€‚</p><ul><li>parse é˜¶æ®µæœ‰<code>@babel/parser</code>ï¼ŒåŠŸèƒ½æ˜¯æŠŠæºç è½¬æˆ AST</li><li>transform é˜¶æ®µæœ‰ <code>@babel/traverse</code>ï¼Œå¯ä»¥éå† ASTï¼Œå¹¶è°ƒç”¨ visitor å‡½æ•°ä¿®æ”¹ ASTï¼Œä¿®æ”¹ AST è‡ªç„¶æ¶‰åŠåˆ° AST çš„åˆ¤æ–­ã€åˆ›å»ºã€ä¿®æ”¹ç­‰ï¼Œè¿™æ—¶å€™å°±éœ€è¦ <code>@babel/types</code> äº†ï¼Œå½“éœ€è¦æ‰¹é‡åˆ›å»º AST çš„æ—¶å€™å¯ä»¥ä½¿ç”¨ <code>@babel/template</code> æ¥ç®€åŒ– AST åˆ›å»ºé€»è¾‘ã€‚</li><li>generate é˜¶æ®µä¼šæŠŠ AST æ‰“å°ä¸ºç›®æ ‡ä»£ç å­—ç¬¦ä¸²ï¼ŒåŒæ—¶ç”Ÿæˆ sourcemapï¼Œéœ€è¦ <code>@babel/generate</code> åŒ…</li><li>ä¸­é€”é‡åˆ°é”™è¯¯æƒ³æ‰“å°ä»£ç ä½ç½®çš„æ—¶å€™ï¼Œä½¿ç”¨ <code>@babel/code-frame</code> åŒ…</li><li>babel çš„æ•´ä½“åŠŸèƒ½é€šè¿‡ <code>@babel/core</code> æä¾›ï¼ŒåŸºäºä¸Šé¢çš„åŒ…å®Œæˆ babel æ•´ä½“çš„ç¼–è¯‘æµç¨‹ï¼Œå¹¶å®ç°æ’ä»¶åŠŸèƒ½ã€‚</li></ul><p>æˆ‘ä»¬ä¸»è¦å­¦ä¹ çš„å°±æ˜¯ <code>@babel/parser</code>ï¼Œ<code>@babel/traverse</code>ï¼Œ<code>@babel/generator</code>ï¼Œ<code>@babel/types</code>ï¼Œ<code>@babel/template</code> è¿™äº”ä¸ªåŒ…çš„ api çš„ä½¿ç”¨ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="babelparser"></a>\@babel/parser<a class="hash-link" href="#babelparser" title="Direct link to heading">#</a></h2><p>babel parser å« babylonï¼Œæ˜¯åŸºäº acorn å®ç°çš„ï¼Œæ‰©å±•äº†å¾ˆå¤šè¯­æ³•ï¼Œå¯ä»¥æ”¯æŒ es nextï¼ˆç°åœ¨æ”¯æŒåˆ° es2020ï¼‰ã€jsxã€flowã€typescript ç­‰è¯­æ³•çš„è§£æï¼Œå…¶ä¸­ jsxã€flowã€typescript è¿™äº›éæ ‡å‡†çš„è¯­æ³•çš„è§£æéœ€è¦æŒ‡å®šè¯­æ³•æ’ä»¶ã€‚</p><p>å®ƒæä¾›äº†æœ‰ä¸¤ä¸ª apiï¼šparse å’Œ parseExpressionã€‚ä¸¤è€…éƒ½æ˜¯æŠŠæºç è½¬æˆ ASTï¼Œä¸è¿‡ parse è¿”å›çš„ AST æ ¹èŠ‚ç‚¹æ˜¯ Fileï¼ˆæ•´ä¸ª ASTï¼‰ï¼ŒparseExpression è¿”å›çš„ AST æ ¹èŠ‚ç‚¹æ˜¯æ˜¯ Expressionï¼ˆè¡¨è¾¾å¼çš„ ASTï¼‰ï¼Œç²’åº¦ä¸åŒã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">input</span><span class="token parameter operator" style="color:#393A34">:</span><span class="token parameter"> string</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> options</span><span class="token parameter operator" style="color:#393A34">?</span><span class="token parameter operator" style="color:#393A34">:</span><span class="token parameter"> ParserOptions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">File</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parseExpression</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">input</span><span class="token parameter operator" style="color:#393A34">:</span><span class="token parameter"> string</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> options</span><span class="token parameter operator" style="color:#393A34">?</span><span class="token parameter operator" style="color:#393A34">:</span><span class="token parameter"> ParserOptions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Expression</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>è¯¦ç»†çš„ options å¯ä»¥æŸ¥çœ‹<a href="https://babeljs.io/docs/en/babel-parser#options" target="_blank" rel="noopener noreferrer">æ–‡æ¡£</a>ã€‚å…¶å®ä¸»è¦åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€æ˜¯ parse çš„å†…å®¹æ˜¯ä»€ä¹ˆï¼ŒäºŒæ˜¯ä»¥ä»€ä¹ˆæ–¹å¼å» parse</p><p><strong>parse çš„å†…å®¹æ˜¯ä»€ä¹ˆï¼š</strong></p><ul><li><code>plugins</code>ï¼š æŒ‡å®šjsxã€typescriptã€flow ç­‰æ’ä»¶æ¥è§£æå¯¹åº”çš„è¯­æ³•</li><li><code>allowXxx</code>ï¼š æŒ‡å®šä¸€äº›è¯­æ³•æ˜¯å¦å…è®¸ï¼Œæ¯”å¦‚å‡½æ•°å¤–çš„ awaitã€æ²¡å£°æ˜çš„ exportç­‰</li><li><code>sourceType</code>ï¼š æŒ‡å®šæ˜¯å¦æ”¯æŒè§£ææ¨¡å—è¯­æ³•ï¼Œæœ‰ moduleã€scriptã€unambiguous 3ä¸ªå–å€¼ï¼Œmodule æ˜¯è§£æ es module è¯­æ³•ï¼Œscript åˆ™ä¸è§£æ es module è¯­æ³•ï¼Œå½“ä½œè„šæœ¬æ‰§è¡Œï¼Œunambiguous åˆ™æ˜¯æ ¹æ®å†…å®¹æ˜¯å¦æœ‰ import å’Œ export æ¥ç¡®å®šæ˜¯å¦è§£æ es module è¯­æ³•ã€‚</li></ul><p><strong>ä»¥ä»€ä¹ˆæ–¹å¼ parse</strong></p><ul><li><code>strictMode</code> æ˜¯å¦æ˜¯ä¸¥æ ¼æ¨¡å¼</li><li><code>startLine</code> ä»æºç å“ªä¸€è¡Œå¼€å§‹ parse</li><li><code>errorRecovery</code> å‡ºé”™æ—¶æ˜¯å¦è®°å½•é”™è¯¯å¹¶ç»§ç»­å¾€ä¸‹ parse</li><li><code>tokens</code> parse çš„æ—¶å€™æ˜¯å¦ä¿ç•™ token ä¿¡æ¯</li><li><code>ranges</code> æ˜¯å¦åœ¨ ast èŠ‚ç‚¹ä¸­æ·»åŠ  ranges å±æ€§</li></ul><p>å…¶å®æœ€å¸¸ç”¨çš„ option å°±æ˜¯ pluginsã€sourceType è¿™ä¸¤ä¸ªï¼Œæ¯”å¦‚è¦ parse tsx æ¨¡å—ï¼Œé‚£ä¹ˆå°±å¯ä»¥è¿™æ ·æ¥å†™</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;@babel/parser&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">parse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;code&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  sourceType</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;module&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  plugins</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;jsx&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;typescript&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="babeltraverse"></a>\@babel/traverse<a class="hash-link" href="#babeltraverse" title="Direct link to heading">#</a></h2><p>parse å‡ºçš„ AST ç”± <code>@babel/traverse</code> æ¥éå†å’Œä¿®æ”¹ï¼Œbabel traverse åŒ…æä¾›äº† traverse æ–¹æ³•ï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">traverse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">parent</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> opts</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>å¸¸ç”¨çš„å°±å‰é¢ä¸¤ä¸ªå‚æ•°ï¼Œparent æŒ‡å®šè¦éå†çš„ AST èŠ‚ç‚¹ï¼Œopts æŒ‡å®š visitor å‡½æ•°ã€‚babel ä¼šåœ¨éå† parent å¯¹åº”çš„ AST æ—¶è°ƒç”¨ç›¸åº”çš„ visitor å‡½æ•°ã€‚</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="éå†è¿‡ç¨‹"></a>éå†è¿‡ç¨‹<a class="hash-link" href="#éå†è¿‡ç¨‹" title="Direct link to heading">#</a></h4><p>visitor å¯¹è±¡çš„ value æ˜¯å¯¹è±¡æˆ–è€…å‡½æ•°ï¼š</p><ul><li>å¦‚æœ value ä¸ºå‡½æ•°ï¼Œé‚£ä¹ˆå°±ç›¸å½“äºæ˜¯ enter æ—¶è°ƒç”¨çš„å‡½æ•°ã€‚</li><li>å¦‚æœ value ä¸ºå¯¹è±¡ï¼Œåˆ™å¯ä»¥æ˜ç¡®æŒ‡å®š enter æˆ–è€… exit æ—¶çš„å¤„ç†å‡½æ•°ã€‚</li></ul><p>å‡½æ•°ä¼šæ¥æ”¶ä¸¤ä¸ªå‚æ•° path å’Œ stateã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">visitor</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function maybe-class-name" style="color:#d73a49">Identifier</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">path</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token maybe-class-name">StringLiteral</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">enter</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">path</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">exit</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">path</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>enter æ—¶è°ƒç”¨æ˜¯åœ¨éå†å½“å‰èŠ‚ç‚¹çš„å­èŠ‚ç‚¹å‰è°ƒç”¨ï¼Œexit æ—¶è°ƒç”¨æ˜¯éå†å®Œå½“å‰èŠ‚ç‚¹çš„å­èŠ‚ç‚¹åè°ƒç”¨ã€‚</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5768a7c151914586ab2a5b09b698b4d7~tplv-k3u1fbpfcp-watermark.image"></p><p>å¯ä»¥ä¸ºå•ä¸ªèŠ‚ç‚¹çš„ç±»å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªèŠ‚ç‚¹ç±»å‹é€šè¿‡ <code>|</code> è¿æ¥ï¼Œè¿˜å¯ä»¥é€šè¿‡åˆ«åæŒ‡å®šä¸€ç³»åˆ—èŠ‚ç‚¹ç±»å‹ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// è¿›å…¥ FunctionDeclaration èŠ‚ç‚¹æ—¶è°ƒç”¨</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">traverse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ast</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token maybe-class-name">FunctionDeclaration</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">enter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">path</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// é»˜è®¤æ˜¯è¿›å…¥èŠ‚ç‚¹æ—¶è°ƒç”¨ï¼Œå’Œä¸Šé¢ç­‰ä»·</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">traverse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ast</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function maybe-class-name" style="color:#d73a49">FunctionDeclaration</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">path</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// è¿›å…¥ FunctionDeclaration å’Œ VariableDeclaration èŠ‚ç‚¹æ—¶è°ƒç”¨</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">traverse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ast</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&#x27;FunctionDeclaration|VariableDeclaration&#x27;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// é€šè¿‡åˆ«åæŒ‡å®šç¦»å¼€å„ç§ Declaration èŠ‚ç‚¹æ—¶è°ƒç”¨</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">traverse</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ast</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token maybe-class-name">Declaration</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">path</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>å…·ä½“çš„åˆ«åæœ‰å“ªäº›åœ¨<a href="https://github.com/babel/babel/blob/main/packages/babel-types/src/ast-types/generated/index.ts#L2489-L2535" target="_blank" rel="noopener noreferrer">babel-types çš„ç±»å‹å®šä¹‰</a>å¯ä»¥æŸ¥ã€‚</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="path"></a>path<a class="hash-link" href="#path" title="Direct link to heading">#</a></h4><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/538aefbdff92426c98c7f1da1feeb246~tplv-k3u1fbpfcp-watermark.image"></p><p>path æ˜¯éå†è¿‡ç¨‹ä¸­çš„è·¯å¾„ï¼Œä¼šä¿ç•™ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œæœ‰å¾ˆå¤šå±æ€§å’Œæ–¹æ³•ï¼Œæ¯”å¦‚:</p><ul><li>path.node æŒ‡å‘å½“å‰ AST èŠ‚ç‚¹</li><li>path.getã€path.set è·å–å’Œè®¾ç½®å½“å‰èŠ‚ç‚¹å±æ€§çš„ path</li><li>path.parent æŒ‡å‘çˆ¶çº§ AST èŠ‚ç‚¹</li><li>path.getSiblingã€path.getNextSiblingã€path.getPrevSibling è·å–å…„å¼ŸèŠ‚ç‚¹</li><li>path.find ä»å½“å‰èŠ‚ç‚¹å‘ä¸ŠæŸ¥æ‰¾èŠ‚ç‚¹</li></ul><p>è¿™äº›å±æ€§å’Œæ–¹æ³•æ˜¯è·å–å½“å‰èŠ‚ç‚¹ä»¥åŠå®ƒçš„å…³è”èŠ‚ç‚¹çš„</p><ul><li>path.scope è·å–å½“å‰èŠ‚ç‚¹çš„ä½œç”¨åŸŸä¿¡æ¯</li></ul><p>è¿™ä¸ªå±æ€§å¯ä»¥è·å–ä½œç”¨åŸŸçš„ä¿¡æ¯</p><ul><li>path.isXxx åˆ¤æ–­å½“å‰èŠ‚ç‚¹æ˜¯ä¸æ˜¯ xx ç±»å‹</li><li>path.assertXxx åˆ¤æ–­å½“å‰èŠ‚ç‚¹æ˜¯ä¸æ˜¯ xx ç±»å‹ï¼Œä¸æ˜¯åˆ™æŠ›å‡ºå¼‚å¸¸</li></ul><p>isXxxã€assertXxx ç³»åˆ—æ–¹æ³•å¯ä»¥ç”¨äºåˆ¤æ–­ AST ç±»å‹</p><ul><li>path.insertBeforeã€path.insertAfter æ’å…¥èŠ‚ç‚¹</li><li>path.replaceWithã€path.replaceWithMultipleã€replaceWithSourceString æ›¿æ¢èŠ‚ç‚¹</li><li>path.remove åˆ é™¤èŠ‚ç‚¹</li></ul><p>è¿™äº›æ–¹æ³•å¯ä»¥å¯¹ AST è¿›è¡Œå¢åˆ æ”¹</p><ul><li>path.skip è·³è¿‡å½“å‰èŠ‚ç‚¹çš„å­èŠ‚ç‚¹çš„éå†</li><li>path.stop ç»“æŸåç»­éå†</li></ul><p>è¿™ä¿©æ–¹æ³•å¯ä»¥è·³è¿‡ä¸€äº›éå†</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/96ed2f4589d341de9b407ef7e58e58a0~tplv-k3u1fbpfcp-watermark.image"></p><p>ä¸Šé¢ç½—åˆ—äº†å‡ ä¸ªå¸¸ç”¨çš„ apiï¼Œå¯ä»¥é€šè¿‡è¿™äº› api å®Œæˆå¯¹ AST çš„æ“ä½œã€‚å½“ç„¶ï¼Œpath çš„ api ä¸æ˜¯åªæœ‰è¿™äº›ï¼Œåé¢å®æˆ˜æ¡ˆä¾‹ç”¨åˆ°äº†å†ä»‹ç»ã€‚</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="state"></a>state<a class="hash-link" href="#state" title="Direct link to heading">#</a></h4><p>ç¬¬äºŒä¸ªå‚æ•° state åˆ™æ˜¯éå†è¿‡ç¨‹ä¸­åœ¨ä¸åŒèŠ‚ç‚¹ä¹‹é—´ä¼ é€’æ•°æ®çš„æœºåˆ¶ï¼Œæ’ä»¶ä¼šé€šè¿‡ state ä¼ é€’ options å’Œ file ä¿¡æ¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ state å­˜å‚¨ä¸€äº›éå†è¿‡ç¨‹ä¸­çš„å…±äº«æ•°æ®ã€‚</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ee26748e8dd54dcca660e593271411be~tplv-k3u1fbpfcp-watermark.image"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="babeltypes"></a>\@babel/types<a class="hash-link" href="#babeltypes" title="Direct link to heading">#</a></h2><p>éå† AST çš„è¿‡ç¨‹ä¸­éœ€è¦åˆ›å»ºä¸€äº› AST å’Œåˆ¤æ–­ AST çš„ç±»å‹ï¼Œè¿™æ—¶å€™å°±éœ€è¦ <code>@babel/types</code> åŒ…ã€‚</p><p>ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœè¦åˆ›å»ºIfStatementå°±å¯ä»¥è°ƒç”¨</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">t</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">ifStatement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> consequent</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> alternate</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>è€Œåˆ¤æ–­èŠ‚ç‚¹æ˜¯å¦æ˜¯ IfStatement å°±å¯ä»¥è°ƒç”¨ isIfStatement æˆ–è€… assertIfStatement</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">t</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">isIfStatement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">node</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> opts</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">t</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">assertIfStatement</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">node</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> opts</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>opts å¯ä»¥æŒ‡å®šä¸€äº›å±æ€§æ˜¯ä»€ä¹ˆå€¼ï¼Œå¢åŠ æ›´å¤šé™åˆ¶æ¡ä»¶ï¼Œåšæ›´ç²¾ç¡®çš„åˆ¤æ–­ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">t</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">isIdentifier</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">node</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;paths&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>isXxx ä¼šè¿”å› boolean è¡¨ç¤ºç»“æœï¼Œè€Œ assertXxx åˆ™ä¼šåœ¨ç±»å‹ä¸ä¸€è‡´æ—¶æŠ›å¼‚å¸¸ã€‚</p><p>æ‰€æœ‰çš„ AST çš„ buildã€assert çš„ api å¯ä»¥åœ¨ <a href="https://babeljs.io/docs/en/babel-types#api" target="_blank" rel="noopener noreferrer">babel types æ–‡æ¡£</a>ä¸­æŸ¥ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="babeltemplate"></a>\@babel/template<a class="hash-link" href="#babeltemplate" title="Direct link to heading">#</a></h2><p>é€šè¿‡ \@babel/types åˆ›å»º AST è¿˜æ˜¯æ¯”è¾ƒéº»çƒ¦çš„ï¼Œè¦ä¸€ä¸ªä¸ªçš„åˆ›å»ºç„¶åç»„è£…ï¼Œå¦‚æœ AST èŠ‚ç‚¹æ¯”è¾ƒå¤šçš„è¯éœ€è¦å†™å¾ˆå¤šä»£ç ï¼Œè¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨ <code>@babel/template</code> åŒ…æ¥æ‰¹é‡åˆ›å»ºã€‚</p><p>è¿™ä¸ªåŒ…æœ‰è¿™äº› apiï¼š</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> ast </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">template</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">code</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">opts</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">args</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> ast </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> template</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">ast</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">code</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">opts</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> ast </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> template</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">program</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">code</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">opts</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>å¦‚æœæ˜¯æ ¹æ®æ¨¡ç‰ˆç›´æ¥åˆ›å»º ASTï¼Œé‚£ä¹ˆç”¨ template.ast æˆ–è€… template.program æ–¹æ³•ï¼Œè¿™ä¿©éƒ½æ˜¯ç›´æ¥è¿”å› ast çš„ï¼Œä½†æ˜¯ template.program è¿”å›çš„ AST çš„æ ¹èŠ‚ç‚¹æ˜¯ Programã€‚</p><p>å¦‚æœçŸ¥é“å…·ä½“åˆ›å»ºçš„ AST çš„ç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨ template.expressionã€template.statementã€template.statements ç­‰æ–¹æ³•ï¼Œå½“æ˜ç¡®åˆ›å»ºçš„ASTçš„ç±»å‹æ—¶å¯ä»¥ä½¿ç”¨ã€‚</p><p>é»˜è®¤ template.ast åˆ›å»ºçš„ Expression ä¼šè¢«åŒ…è£¹ä¸€å±‚ ExpressionStatement èŠ‚ç‚¹ï¼ˆä¼šè¢«å½“æˆè¡¨è¾¾å¼è¯­å¥æ¥ parseï¼‰ï¼Œä½†å½“ template.expression æ–¹æ³•åˆ›å»ºçš„ AST å°±ä¸ä¼šã€‚</p><p>å¦‚æœæ¨¡ç‰ˆä¸­æœ‰å ä½ç¬¦ï¼Œé‚£ä¹ˆå°±ç”¨ template çš„ apiï¼Œåœ¨æ¨¡ç‰ˆä¸­å†™ä¸€äº›å ä½çš„å‚æ•°ï¼Œè°ƒç”¨æ—¶ä¼ å…¥è¿™äº›å ä½ç¬¦å‚æ•°å¯¹åº”çš„ AST èŠ‚ç‚¹ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> fn </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">template</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">console.log(NAME)</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> ast </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token constant" style="color:#36acaa">NAME</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> t</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">stringLiteral</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;guang&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>æˆ–è€…</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> fn </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">template</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">console.log(%%NAME%%)</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> ast </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token constant" style="color:#36acaa">NAME</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> t</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">stringLiteral</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;guang&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>è¿™ä¸¤ç§å ä½ç¬¦çš„å†™æ³•éƒ½å¯ä»¥ï¼Œå½“å ä½ç¬¦å’Œå…¶ä»–å˜é‡åå†²çªæ—¶å¯ä»¥ç”¨ç¬¬äºŒç§ã€‚</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="babelgenerator"></a>\@babel/generator<a class="hash-link" href="#babelgenerator" title="Direct link to heading">#</a></h2><p>AST è½¬æ¢å®Œä¹‹åå°±è¦æ‰“å°æˆç›®æ ‡ä»£ç å­—ç¬¦ä¸²ï¼Œé€šè¿‡ <code>@babel/generator</code> åŒ…çš„ generate api</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">ast</span><span class="token parameter operator" style="color:#393A34">:</span><span class="token parameter"> Object</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> opts</span><span class="token parameter operator" style="color:#393A34">:</span><span class="token parameter"> Object</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> code</span><span class="token parameter operator" style="color:#393A34">:</span><span class="token parameter"> string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">code</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> map</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦æ‰“å°çš„ AST</p><p>ç¬¬äºŒä¸ªå‚æ•°æ˜¯ optionsï¼ŒæŒ‡å®šæ‰“å°çš„ä¸€äº›ç»†èŠ‚ï¼Œæ¯”å¦‚é€šè¿‡ comments æŒ‡å®šæ˜¯å¦åŒ…å«æ³¨é‡Šï¼Œé€šè¿‡ minified æŒ‡å®šæ˜¯å¦åŒ…å«ç©ºç™½å­—ç¬¦</p><p>ç¬¬ä¸‰ä¸ªå‚æ•°å½“<a href="/docs/books/babel/null">å¤šä¸ªæ–‡ä»¶åˆå¹¶æ‰“å°</a>çš„æ—¶å€™éœ€è¦ç”¨åˆ°</p><p>options ä¸­å¸¸ç”¨çš„æ˜¯ sourceMapsï¼Œå¼€å¯äº†è¿™ä¸ªé€‰é¡¹æ‰ä¼šç”Ÿæˆ sourcemap</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> code</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> map </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">generate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ast</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> sourceMaps</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="babelcode-frame"></a>\@babel/code-frame<a class="hash-link" href="#babelcode-frame" title="Direct link to heading">#</a></h2><p>å½“æœ‰é”™è¯¯ä¿¡æ¯è¦æ‰“å°çš„æ—¶å€™ï¼Œéœ€è¦æ‰“å°é”™è¯¯ä½ç½®çš„ä»£ç ï¼Œå¯ä»¥ä½¿ç”¨<code>@babel/code-frame</code>ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">codeFrameColumns</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rawLines</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">location</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">/* options */</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>options å¯ä»¥è®¾ç½® highlighted ï¼ˆæ˜¯å¦é«˜äº®ï¼‰ã€messageï¼ˆå±•ç¤ºå•¥é”™è¯¯ä¿¡æ¯ï¼‰ã€‚</p><p>æ¯”å¦‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> codeFrameColumns </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;@babel/code-frame&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword control-flow" style="color:#00009f">try</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">throw</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;xxx é”™è¯¯&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">codeFrameColumns</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">const name = guang</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      start</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> line</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> column</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">14</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    highlightCode</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    message</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> err</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">message</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>ä¼šæœ‰æ¯”è¾ƒå‹å¥½çš„æ‰“å°ä¿¡æ¯</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e31ce65fd2f644439f2848b0e0e94c1b~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="babelcore"></a>\@babel/core<a class="hash-link" href="#babelcore" title="Direct link to heading">#</a></h2><p>å‰é¢çš„åŒ…æ˜¯å®ŒæˆæŸä¸€éƒ¨åˆ†çš„åŠŸèƒ½çš„ï¼Œè€Œ <code>@babel/core</code> åŒ…åˆ™æ˜¯åŸºäºå®ƒä»¬å®Œæˆæ•´ä¸ªç¼–è¯‘æµç¨‹ï¼Œä»æºç åˆ°ç›®æ ‡ä»£ç ï¼Œç”Ÿæˆ sourcemapã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">transformSync</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">code</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// =&gt; { code, map, ast }</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">transformFileSync</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">filename</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// =&gt; { code, map, ast }</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">transformFromAstSync</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  parsedAst</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  sourceCode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  options</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// =&gt; { code, map, ast }</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>å‰ä¸‰ä¸ª transformXxx çš„ api åˆ†åˆ«æ˜¯ä»æºä»£ç ã€æºä»£ç æ–‡ä»¶ã€æºä»£ç  AST è¿™å¼€å§‹å¤„ç†ï¼Œæœ€ç»ˆç”Ÿæˆç›®æ ‡ä»£ç å’Œ sourcemapã€‚</p><p>options ä¸»è¦é…ç½® plugins å’Œ presetsï¼ŒæŒ‡å®šå…·ä½“è¦åšä»€ä¹ˆè½¬æ¢ã€‚</p><p>è¿™äº› api ä¹ŸåŒæ ·æä¾›äº†å¼‚æ­¥çš„ç‰ˆæœ¬ï¼Œå¼‚æ­¥åœ°è¿›è¡Œç¼–è¯‘ï¼Œè¿”å›ä¸€ä¸ª promise</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">transformAsync</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;code();&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">result</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">transformFileAsync</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;filename.js&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">result</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">transformFromAstAsync</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parsedAst</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sourceCode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">result</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>æ³¨æ„ï¼štransformXxx çš„ apiï¼Œå·²ç»è¢«æ ‡è®°ä¸ºè¿‡æ—¶äº†ï¼Œåç»­ä¼šåˆ æ‰ï¼Œä¸å»ºè®®ç”¨ï¼Œç›´æ¥ç”¨ transformXxxSync å’Œ transformXxxAsyncã€‚</p><p>\@babel/core åŒ…è¿˜æœ‰ä¸€ä¸ª createConfigItem çš„ apiï¼Œç”¨äº plugin å’Œ preset çš„å°è£…ï¼Œåé¢ç« èŠ‚ä¼šæ¶‰åŠåˆ°ã€‚</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">createConfigItem</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// configItem</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="æ€»ç»“"></a>æ€»ç»“<a class="hash-link" href="#æ€»ç»“" title="Direct link to heading">#</a></h2><p>è¿™ä¸€èŠ‚æˆ‘ä»¬äº†è§£äº†ç¼–è¯‘è¿‡ç¨‹ä¸­å„é˜¶æ®µçš„ apiï¼š</p><ul><li><code>@babel/parser</code> å¯¹æºç è¿›è¡Œ parseï¼Œå¯ä»¥é€šè¿‡ pluginsã€sourceType ç­‰æ¥æŒ‡å®š parse è¯­æ³•</li><li><code>@babel/traverse</code> é€šè¿‡ visitor å‡½æ•°å¯¹éå†åˆ°çš„ ast è¿›è¡Œå¤„ç†ï¼Œåˆ†ä¸º enter å’Œ exit ä¸¤ä¸ªé˜¶æ®µï¼Œå…·ä½“æ“ä½œ AST ä½¿ç”¨ path çš„ apiï¼Œè¿˜å¯ä»¥é€šè¿‡ state æ¥åœ¨éå†è¿‡ç¨‹ä¸­ä¼ é€’ä¸€äº›æ•°æ®</li><li><code>@babel/types</code> ç”¨äºåˆ›å»ºã€åˆ¤æ–­ AST èŠ‚ç‚¹ï¼Œæä¾›äº† xxxã€isXxxã€assertXxx çš„ api</li><li><code>@babel/template</code> ç”¨äºæ‰¹é‡åˆ›å»ºèŠ‚ç‚¹</li><li><code>@babel/code-frame</code> å¯ä»¥åˆ›å»ºå‹å¥½çš„æŠ¥é”™ä¿¡æ¯</li><li><code>@babel/generator</code> æ‰“å° AST æˆç›®æ ‡ä»£ç å­—ç¬¦ä¸²ï¼Œæ”¯æŒ commentsã€minifiedã€sourceMaps ç­‰é€‰é¡¹ã€‚</li><li><code>@babel/core</code> åŸºäºä¸Šé¢çš„åŒ…æ¥å®Œæˆ babel çš„ç¼–è¯‘æµç¨‹ï¼Œå¯ä»¥ä»æºç å­—ç¬¦ä¸²ã€æºç æ–‡ä»¶ã€AST å¼€å§‹ã€‚</li></ul><p>å­¦å®Œè¿™ä¸€èŠ‚ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ babel çš„ api æ¥å®ç°ä¸€äº›åŠŸèƒ½äº†ï¼Œä¸‹ä¸€èŠ‚å¼€å§‹ç¬¬ä¸€ä¸ªå®æˆ˜æ¡ˆä¾‹ã€‚</p></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://gitee.com/zhangyapeng/doc/tree/master/docs/books/babel/4ã€Babel çš„ api.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF">Last updated on <b><time datetime="2021-10-09T08:10:49.000Z">10/9/2021</time></b></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#babel-çš„-api-æœ‰å“ªäº›" class="table-of-contents__link">babel çš„ api æœ‰å“ªäº›</a></li><li><a href="#babelparser" class="table-of-contents__link">@babel/parser</a></li><li><a href="#babeltraverse" class="table-of-contents__link">@babel/traverse</a></li><li><a href="#babeltypes" class="table-of-contents__link">@babel/types</a></li><li><a href="#babeltemplate" class="table-of-contents__link">@babel/template</a></li><li><a href="#babelgenerator" class="table-of-contents__link">@babel/generator</a></li><li><a href="#babelcode-frame" class="table-of-contents__link">@babel/code-frame</a></li><li><a href="#babelcore" class="table-of-contents__link">@babel/core</a></li><li><a href="#æ€»ç»“" class="table-of-contents__link">æ€»ç»“</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 dapeng (å¼ äºšé¹) Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.beccc056.js"></script>
<script src="/assets/js/main.f67a5996.js"></script>
</body>
</html>